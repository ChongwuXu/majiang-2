var __reflect=this&&this.__reflect||function(e,t,a){e.__class__=t,a?a.push(t):a=[t],e.__types__=e.__types__?a.concat(e.__types__):a},__extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var a in t)t.hasOwnProperty(a)&&(e[a]=t[a])};return function(t,a){function o(){this.constructor=t}e(t,a),t.prototype=null===a?Object.create(a):(o.prototype=a.prototype,new o)}}(),game;!function(e){var t=function(t){function a(){var a=t.call(this)||this;return a.m_nTimeOnEnterFrame=0,a.m_aClickBtns=[],a.m_oHandle=new e.Handle,a.once(eui.UIEvent.COMPLETE,a.fOnUICreate,a),a}return __extends(a,t),a.prototype.fOnUICreate=function(){this.addEventListener(egret.Event.ENTER_FRAME,this.fEnterFrame,this),this.m_nTimeOnEnterFrame=egret.getTimer()},a.prototype.fEnterFrame=function(){this.fUpdate(egret.getTimer()-this.m_nTimeOnEnterFrame),this.m_nTimeOnEnterFrame=egret.getTimer()},a.prototype.fSetVisible=function(e){this.visible=e,this.visible?(this.addEventListener(egret.Event.ENTER_FRAME,this.fEnterFrame,this),this.m_nTimeOnEnterFrame=egret.getTimer()):this.removeEventListener(egret.Event.ENTER_FRAME,this.fEnterFrame,this)},a.prototype.fSceneResGroup=function(){return""},a.prototype.fUpdate=function(e){},a.prototype.fSetClickButton=function(t){-1==this.m_aClickBtns.indexOf(t)&&(this.m_aClickBtns.push(t),t instanceof e.Button?t.fBindListener(this):t instanceof eui.RadioButton?t.addEventListener(egret.Event.CHANGE,this.fTouchTap,this):t.addEventListener(egret.TouchEvent.TOUCH_TAP,this.fTouchTap,this))},a.prototype.fTouchTap=function(e){var t=e.currentTarget;this.fOnClick(t)},a.prototype.fOnClick=function(e){},a.prototype.fRelease=function(){for(var e in this.m_aClickBtns)this.fRemoveClickEvent(this.m_aClickBtns[e]);this.removeEventListener(egret.Event.ENTER_FRAME,this.fEnterFrame,this)},a.prototype.fRemoveClickEvent=function(t){t instanceof e.Button?t.fRelease():t.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.fTouchTap,this)},a}(eui.Component);e.Scene=t,__reflect(t.prototype,"game.Scene")}(game||(game={}));var game;!function(e){var t=function(){function t(){this.m_nErrcode=0}return t.prototype.fWrite=function(){var t=new e.GameByteArray;return t.writeShort(this.m_nPktType),t.writeInt(this.m_nErrcode),t},t.prototype.fRead=function(e){this.m_nPktLen=e.readShort(),this.m_nPktType=e.readShort(),this.m_nErrcode=e.readInt()},t}();__reflect(t.prototype,"PacketHead");var a=function(){function a(){this.m_oHead=new t}return a.prototype.fWrite=function(){return this.m_oHead.fWrite()},a.prototype.fRead=function(e){this.m_oHead.fRead(e)},a.prototype.fGetHead=function(){return this.m_oHead},a.prototype.fGetPacketName=function(){return this.m_sActionType},a.fInitPacketMap=function(){a.s_aPacketMapStrValue.length||(a.s_aPacketMapStrValue.push([e.Packet.s_PlayHand,function(){return new e.C2s_PlayHandAction}]),a.s_aPacketMapStrValue.push([e.Packet.s_Touch,function(){return new e.C2s_TouchPacket}]),a.s_aPacketMapStrValue.push([e.Packet.s_Eat,function(){return new e.C2s_EatAction}]),a.s_aPacketMapStrValue.push([e.Packet.s_Peng,function(){return new e.C2s_PengAction}]),a.s_aPacketMapStrValue.push([e.Packet.s_Gang,function(){return new e.C2s_GangAction}]),a.s_aPacketMapStrValue.push([e.Packet.s_BeginGame,function(){return new e.C2s_BeginGamePacket}]),a.s_aPacketMapStrValue.push([e.Packet.s_CreateRoom,function(){return new e.C2s_CreateRoomPacket}]),a.s_aPacketMapStrValue.push([e.Packet.s_JoinRoom,function(){return new e.C2s_JoinRoomPacket}]),a.s_aPacketMapStrValue.push([e.Packet.s_Login,function(){return new e.C2s_GameLogin}]),a.s_aPacketMapStrValue.push([e.Packet.s_RoomInfo,function(){return new e.C2s_RoomInfoPacket}]),a.s_aPacketMapStrValue.push([e.Packet.s_PlayerReady,function(){return new e.S2C_ReadyActive}]),a.s_aPacketMapStrValue.push([e.Packet.s_Speak,function(){return new e.C2s_SpeakPacket}]),a.s_aPacketMapNumValue.push([e.Protocol.s_C2S_PLAYHAND,function(){return new e.C2s_PlayHandAction}]),a.s_aPacketMapNumValue.push([e.Protocol.s_C2S_MOPAI,function(){return new e.C2s_TouchPacket}]),a.s_aPacketMapNumValue.push([e.Protocol.s_C2S_EAT_PAI,function(){return new e.C2s_EatAction}]),a.s_aPacketMapNumValue.push([e.Protocol.s_C2S_PENG_PAI,function(){return new e.C2s_PengAction}]),a.s_aPacketMapNumValue.push([e.Protocol.s_C2S_GANG_PAI,function(){return new e.C2s_GangAction}]),a.s_aPacketMapNumValue.push([e.Protocol.s_C2S_StartHand,function(){return new e.C2s_BeginGamePacket}]),a.s_aPacketMapNumValue.push([e.Protocol.s_C2S_CREATEROOM,function(){return new e.C2s_CreateRoomPacket}]),a.s_aPacketMapNumValue.push([e.Protocol.s_C2S_JOINROOM,function(){return new e.C2s_JoinRoomPacket}]),a.s_aPacketMapNumValue.push([e.Protocol.s_C2S_LOGIN,function(){return new e.C2s_GameLogin}]),a.s_aPacketMapNumValue.push([e.Protocol.s_C2S_ROOMINFO,function(){return new e.C2s_RoomInfoPacket}]),a.s_aPacketMapNumValue.push([e.Protocol.s_C2S_Ready,function(){return new e.S2C_ReadyActive}]),a.s_aPacketMapNumValue.push([e.Protocol.s_C2S_SPEAK,function(){return new e.C2s_SpeakPacket}]),a.s_aPacketMapNumStr.push([e.Protocol.s_C2S_PLAYHAND,e.Packet.s_PlayHand]),a.s_aPacketMapNumStr.push([e.Protocol.s_C2S_MOPAI,e.Packet.s_Touch]),a.s_aPacketMapNumStr.push([e.Protocol.s_C2S_EAT_PAI,e.Packet.s_Eat]),a.s_aPacketMapNumStr.push([e.Protocol.s_C2S_PENG_PAI,e.Packet.s_Peng]),a.s_aPacketMapNumStr.push([e.Protocol.s_C2S_GANG_PAI,e.Packet.s_Gang]),a.s_aPacketMapNumStr.push([e.Protocol.s_C2S_StartHand,e.Packet.s_BeginGame]),a.s_aPacketMapNumStr.push([e.Protocol.s_C2S_CREATEROOM,e.Packet.s_CreateRoom]),a.s_aPacketMapNumStr.push([e.Protocol.s_C2S_JOINROOM,e.Packet.s_JoinRoom]),a.s_aPacketMapNumStr.push([e.Protocol.s_C2S_LOGIN,e.Packet.s_Login]),a.s_aPacketMapNumStr.push([e.Protocol.s_C2S_ROOMINFO,e.Packet.s_RoomInfo]),a.s_aPacketMapNumStr.push([e.Protocol.s_C2S_Ready,e.Packet.s_PlayerReady]),a.s_aPacketMapNumStr.push([e.Protocol.s_C2S_SPEAK,e.Packet.s_Speak]))},a.fGetPacketNameById=function(e){for(var t=0;t<a.s_aPacketMapNumStr.length;t++)if(a.s_aPacketMapNumStr[t][0]==e)return a.s_aPacketMapNumStr[t][1]},a.fCreateAction=function(e){var t=null;if(!a.s_aPacketMapStrValue.length)return console.warn("Packet.s_aPacketMap 未初始化"),null;for(var o in a.s_aPacketMapStrValue)a.s_aPacketMapStrValue[o][0]==e&&(t=a.s_aPacketMapStrValue[o][1]());return null==t&&console.warn("C2s_ActionBase.CreateAction fail "+e),t},a.prototype.fGetActionType=function(){return this.m_sActionType},a.fCreatePkt=function(e){var t=null;if(!a.s_aPacketMapNumValue.length)return console.warn("Packet.s_aPacketMap 未初始化"),null;for(var o in a.s_aPacketMapNumValue)a.s_aPacketMapNumValue[o][0]==e&&(t=a.s_aPacketMapNumValue[o][1]());return null==t&&console.warn("fCreatePkt fail"+e),t},a.s_aPacketMapStrValue=[],a.s_aPacketMapNumValue=[],a.s_aPacketMapNumStr=[],a.s_Eat="吃牌",a.s_Peng="碰牌",a.s_Gang="杠牌",a.s_Touch="摸牌",a.s_PlayHand="出牌",a.s_BeginGame="开始打牌",a.s_CreateRoom="创建房间",a.s_JoinRoom="加入房间",a.s_BaseAct="基本",a.s_Login="登录",a.s_Heart="心跳",a.s_RoomInfo="房间信息",a.s_PlayerReady="玩家准备",a.s_Speak="语音聊天",a}();e.Packet=a,__reflect(a.prototype,"game.Packet")}(game||(game={}));var game;!function(e){var t=function(){function t(e,t,a){this.m_aAction=[],this.m_nType=e,this.m_nIndex=a,this.m_nValue=t}return t.prototype.fRead=function(e){this.m_nType=e.readShort(),this.m_nValue=e.readShort(),this.m_nIndex=e.readShort(),this.m_nPriority=e.readShort(),this.m_sName=e.readUTF()},t.prototype.fWrite=function(e){return e.writeShort(this.m_nType),e.writeShort(this.m_nValue),e.writeShort(this.m_nIndex),e.writeShort(this.m_nPriority),e.writeUTF(this.m_sName),e},t.fInsetCard=function(e,t){for(var a=0,o=t.length,n=Math.floor((o+a)/2);n>0&&o-1>n;){if(e.m_nPriority>=t[n-1].m_nPriority&&e.m_nPriority<=t[n+1].m_nPriority)return void((o+a)%2==0?t.splice(n+1,0,e):t.splice(n+1,0,e));n=e.m_nPriority>t[n].m_nPriority?Math.floor((o+n)/2):Math.floor(n/2)}0!=n?t.splice(n+1,0,e):t.splice(n,0,e)},t.prototype.fEqual=function(e,t){return void 0===t&&(t=!1),t?this.m_nType==e.m_nType&&this.m_nValue==e.m_nValue&&this.m_nIndex==e.m_nIndex?!0:!1:this.m_nType==e.m_nType&&this.m_nValue==e.m_nValue?!0:!1},t.prototype.fGetType=function(){return this.m_nType},t.prototype.fSetType=function(e){this.m_nType=e},t.prototype.fGetValue=function(){return this.m_nValue},t.prototype.fSetValue=function(e){this.m_nValue=e},t.prototype.fGetIndex=function(){return this.m_nIndex},t.fCreateCard=function(t,a,o){switch(t){case e.FengCard.s_Type_Feng:return new e.FengCard(t,a,o);case e.HuaCard.s_Type_Hua:return new e.HuaCard(t,a,o);case e.JianCard.s_Type_Jian:return new e.JianCard(t,a,o);case e.TiaoCard.s_Type_Tiao:return new e.TiaoCard(t,a,o);case e.WanCard.s_Type_Wan:return new e.WanCard(t,a,o);case e.WanCard.s_Type_Tong:return new e.TongCard(t,a,o);default:return alert("生成Card失败"+t+a+o),null}},t.s_Type_Feng=0,t.s_Value_Feng_Dong=0,t.s_Value_Feng_Nan=2,t.s_Value_Feng_Xi=1,t.s_Value_Feng_Bei=3,t.s_Type_Hua=1,t.s_Value_Hua_Chun=0,t.s_Value_Hua_Xia=1,t.s_Value_Hua_Qiu=2,t.s_Value_Hua_Dong=3,t.s_Value_Hua_Mei=4,t.s_Value_Hua_Lan=5,t.s_Value_Hua_Zhu=6,t.s_Value_Hua_Ju=7,t.s_Type_Jian=2,t.s_Value_Jian_Zhong=0,t.s_Value_Jian_Fa=1,t.s_Value_Jian_Bai=2,t.s_Type_Tiao=3,t.s_Value_Tiao_1=1,t.s_Value_Tiao_2=2,t.s_Value_Tiao_3=3,t.s_Value_Tiao_4=4,t.s_Value_Tiao_5=5,t.s_Value_Tiao_6=6,t.s_Value_Tiao_7=7,t.s_Value_Tiao_8=8,t.s_Value_Tiao_9=9,t.s_Type_Tong=4,t.s_Value_Tong_1=1,t.s_Value_Tong_2=2,t.s_Value_Tong_3=3,t.s_Value_Tong_4=4,t.s_Value_Tong_5=5,t.s_Value_Tong_6=6,t.s_Value_Tong_7=7,t.s_Value_Tong_8=8,t.s_Value_Tong_9=9,t.s_Type_Wan=5,t.s_Value_Wan_1=1,t.s_Value_Wan_2=2,t.s_Value_Wan_3=3,t.s_Value_Wan_4=4,t.s_Value_Wan_5=5,t.s_Value_Wan_6=6,t.s_Value_Wan_7=7,t.s_Value_Wan_8=8,t.s_Value_Wan_9=9,t}();e.CardBase=t,__reflect(t.prototype,"game.CardBase")}(game||(game={}));var game;!function(e){var t=function(){function e(){this.m_nMaxSceneCount=5,this.m_oSceneStack=[]}return e.prototype.fGetTopScene=function(){return this.m_oSceneStack.length<1?null:this.m_oSceneStack[this.m_oSceneStack.length-1]},e.prototype.fAddScene=function(e){var t=this.fGetTopScene();return this.m_oLastScene=t,void 0!=e&&t!=e?(this.m_oSceneStack.length>=this.m_nMaxSceneCount&&this.m_oSceneStack.shift(),this.m_oSceneStack.push(e),!0):!1},e.prototype.fGetSceneStackLength=function(){return this.m_oSceneStack.length},e.prototype.fClear=function(){this.m_oSceneStack=[]},e.prototype.fGetLastScene=function(){return this.m_oLastScene},e.prototype.fPop=function(){this.m_oLastScene=this.fGetTopScene(),this.m_oSceneStack.pop()},e}();e.SceneManager=t,__reflect(t.prototype,"game.SceneManager")}(game||(game={}));var game;!function(e){var t=function(t){function a(){var a=t.call(this)||this;return a.m_aGroupCards=[],a.m_oHead.m_nPktType=e.Protocol.s_C2S_BASE,a.m_sActionType=e.Packet.s_BaseAct,a}return __extends(a,t),a.prototype.fGetCurrPlayrPos=function(){return this.m_pCurrentPlayer},a.prototype.fGetBelongPlayerPos=function(){return this.m_pBelongPlayer},a.prototype.fGetCards=function(){return this.m_aGroupCards},a.prototype.fSetCards=function(e){this.m_aGroupCards=e},a.prototype.fWrite=function(){var e=t.prototype.fWrite.call(this);e.writeShort(this.m_pBelongPlayer),e.writeShort(this.m_pCurrentPlayer),e.writeShort(this.m_nCardsGroupCount);for(var a in this.m_aGroupCards)this.m_aGroupCards[a].fWrite(e);return e},a.prototype.fRead=function(a){if(t.prototype.fRead.call(this,a),this.m_pBelongPlayer=a.readShort(),this.m_pCurrentPlayer=a.readShort(),this.m_nCardsGroupCount=a.readShort(),this.m_pBelongPlayer==this.m_pCurrentPlayer||this.m_oHead.m_nPktType==e.Protocol.s_C2S_PLAYHAND)for(var o=0;o<this.m_nCardsGroupCount;o++){var n=new e.CardGroup;n.fRead(a),this.m_aGroupCards.push(n)}},a}(e.Packet);e.C2s_ActionBase=t,__reflect(t.prototype,"game.C2s_ActionBase")}(game||(game={}));var game;!function(e){var t=function(e){function t(t){var a=e.call(this)||this;return a.m_oCardBase=t,a}return __extends(t,e),t.prototype.fOnUICreate=function(){this.m_labName.text=this.m_oCardBase.m_sName},t.prototype.fOnClick=function(e){},t}(e.Scene);e.DeskCard=t,__reflect(t.prototype,"game.DeskCard")}(game||(game={}));var game;!function(e){var t=function(t){function a(){var a=t.call(this)||this;return a.m_oHead.m_nPktType=e.Protocol.s_C2S_PLAYHAND,a.m_sActionType=e.Packet.s_PlayHand,a}return __extends(a,t),a.prototype.fWrite=function(){var e=t.prototype.fWrite.call(this);return e},a.prototype.fRead=function(a){t.prototype.fRead.call(this,a);var o=this.m_aGroupCards[0].fGetCard()[0];e.GameManager.fGetIns().m_oChuHandCard=new e.HandCardDown(o),this.fVerifyNumber()},a.prototype.fVerifyNumber=function(){},a}(e.C2s_ActionBase);e.C2s_PlayHandAction=t,__reflect(t.prototype,"game.C2s_PlayHandAction")}(game||(game={}));var game;!function(e){var t=function(t){function a(a,o,n){var r=t.call(this,a,o,n)||this;return e.CardBase.s_Value_Hua_Chun==o?r.m_sName="春":e.CardBase.s_Value_Hua_Xia==o?r.m_sName="夏":e.CardBase.s_Value_Hua_Qiu==o?r.m_sName="秋":e.CardBase.s_Value_Hua_Dong==o?r.m_sName="冬":e.CardBase.s_Value_Hua_Mei==o?r.m_sName="梅":e.CardBase.s_Value_Hua_Lan==o?r.m_sName="兰":e.CardBase.s_Value_Hua_Zhu==o?r.m_sName="竹":e.CardBase.s_Value_Hua_Ju==o?r.m_sName="菊":e.TipShow.fShow("HuaCard 创建失败:value ="+o),r}return __extends(a,t),a}(e.CardBase);e.HuaCard=t,__reflect(t.prototype,"game.HuaCard")}(game||(game={}));var game;!function(e){var t=function(t){function a(a,o,n){var r=t.call(this,a,o,n)||this;return o==e.CardBase.s_Value_Jian_Zhong?r.m_sName="中":o==e.CardBase.s_Value_Jian_Fa?r.m_sName="发":o==e.CardBase.s_Value_Jian_Bai?r.m_sName="白":e.TipShow.fShow("JianCard 创建失败:value ="+o),r}return __extends(a,t),a}(e.CardBase);e.JianCard=t,__reflect(t.prototype,"game.JianCard")}(game||(game={}));var game;!function(e){var t=function(t){function a(a,o,n){var r=t.call(this,a,o,n)||this;return o==e.CardBase.s_Value_Tiao_1?r.m_sName="一条":o==e.CardBase.s_Value_Tiao_2?r.m_sName="二条":o==e.CardBase.s_Value_Tiao_3?r.m_sName="三条":o==e.CardBase.s_Value_Tiao_4?r.m_sName="四条":o==e.CardBase.s_Value_Tiao_5?r.m_sName="五条":o==e.CardBase.s_Value_Tiao_6?r.m_sName="六条":o==e.CardBase.s_Value_Tiao_7?r.m_sName="七条":o==e.CardBase.s_Value_Tiao_8?r.m_sName="八条":o==e.CardBase.s_Value_Tiao_9?r.m_sName="九条":e.TipShow.fShow("TiaoCard 创建失败:value ="+o),r}return __extends(a,t),a}(e.CardBase);e.TiaoCard=t,__reflect(t.prototype,"game.TiaoCard")}(game||(game={}));var game;!function(e){var t=function(t){function a(a,o,n){var r=t.call(this,a,o,n)||this;return o==e.CardBase.s_Value_Tong_1?r.m_sName="一筒":o==e.CardBase.s_Value_Tong_2?r.m_sName="二筒":o==e.CardBase.s_Value_Tong_3?r.m_sName="三筒":o==e.CardBase.s_Value_Tong_4?r.m_sName="四筒":o==e.CardBase.s_Value_Tong_5?r.m_sName="五筒":o==e.CardBase.s_Value_Tong_6?r.m_sName="六筒":o==e.CardBase.s_Value_Tong_7?r.m_sName="七筒":o==e.CardBase.s_Value_Tong_8?r.m_sName="八筒":o==e.CardBase.s_Value_Tong_9?r.m_sName="九筒":e.TipShow.fShow("TongCard 创建失败:value ="+o),r}return __extends(a,t),a}(e.CardBase);e.TongCard=t,__reflect(t.prototype,"game.TongCard")}(game||(game={}));var game;!function(e){var t=function(t){function a(a,o,n){var r=t.call(this,a,o,n)||this;return o==e.CardBase.s_Value_Wan_1?r.m_sName="一万":o==e.CardBase.s_Value_Wan_2?r.m_sName="二万":o==e.CardBase.s_Value_Wan_3?r.m_sName="三万":o==e.CardBase.s_Value_Wan_4?r.m_sName="四万":o==e.CardBase.s_Value_Wan_5?r.m_sName="五万":o==e.CardBase.s_Value_Wan_6?r.m_sName="六万":o==e.CardBase.s_Value_Wan_7?r.m_sName="七万":o==e.CardBase.s_Value_Wan_8?r.m_sName="八万":o==e.CardBase.s_Value_Wan_9?r.m_sName="九万":e.TipShow.fShow("WanCard 创建失败:value ="+o),r}return __extends(a,t),a}(e.CardBase);e.WanCard=t,__reflect(t.prototype,"game.WanCard")}(game||(game={}));var game;!function(e){var t=function(){function t(){}return t.prototype.fSendMessage=function(t,a){a?e.Poster.Ins.dispatchEvent(new e.MessageEvent(t,a)):e.Poster.Ins.dispatchEvent(new e.MessageEvent(t))},t.prototype.fReceiveMessage=function(t,a){for(var o=[],n=2;n<arguments.length;n++)o[n-2]=arguments[n];this.m_oContent=t,this.m_fMessListener=a,this.m_aMsgName=o;var r=e.Poster.Ins;for(var i in o)r.addEventListener(o[i],a,t)},t.prototype.fReceiveOnce=function(t,a){for(var o=[],n=2;n<arguments.length;n++)o[n-2]=arguments[n];this.m_oOnceContent=t,this.m_fOnceListener=a,this.m_aOnceMsgName=o;var r=e.Poster.Ins;for(var i in o)r.once(o[i],a,t);r=null},t.prototype.fRelease=function(){var t=e.Poster.Ins;if(this.m_fMessListener)for(var a in this.m_aMsgName)t.removeEventListener(this.m_aMsgName[a],this.m_fMessListener,this.m_oContent);if(this.m_fOnceListener)for(var a in this.m_aMsgName)t.removeEventListener(this.m_aOnceMsgName[a],this.m_fOnceListener,this.m_oOnceContent)},t}();e.Handle=t,__reflect(t.prototype,"game.Handle")}(game||(game={}));var game;!function(e){var t=function(e){function t(t,a){var o=e.call(this,t)||this;return o.m_oDisObj=a,o.m_sName=t,o}return __extends(t,e),t}(egret.Event);e.MessageEvent=t,__reflect(t.prototype,"game.MessageEvent")}(game||(game={}));var game;!function(e){var t=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),Object.defineProperty(t,"Ins",{get:function(){return null==this.s_Ins&&(this.s_Ins=new t),this.s_Ins},enumerable:!0,configurable:!0}),t}(egret.EventDispatcher);e.Poster=t,__reflect(t.prototype,"game.Poster")}(game||(game={}));var game;!function(e){var t;!function(e){e[e.e_Unknow=-1]="e_Unknow",e[e.e_Up=0]="e_Up",e[e.e_Down=2]="e_Down",e[e.e_Left=1]="e_Left",e[e.e_Right=3]="e_Right",e[e.e_Desktop=4]="e_Desktop"}(t=e.PlayePosition||(e.PlayePosition={}));var a=function(){function e(e){this.m_aHandCards=[],this.m_aEatCards=[],this.m_aPengCards=[],this.m_aGangCards=[],this.m_pPosition=e}return e.prototype.fGetPosition=function(){return this.m_pPosition},e.prototype.fSetPosition=function(e){this.m_pPosition=e},e}();e.Player=a,__reflect(a.prototype,"game.Player")}(game||(game={}));var Main=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.isThemeLoadEnd=!1,t.isResourceLoadEnd=!1,t}return __extends(t,e),t.fGetIns=function(){return t.s_Ins},t.prototype.createChildren=function(){e.prototype.createChildren.call(this),console.info("hahahaa"),t.s_Ins=this,e.prototype.createChildren.call(this);Utils.fGetInitFaPaiDistance(2,3);this.m_oGameSocket=new game.GameSocket;var a=new AssetAdapter;egret.registerImplementation("eui.IAssetAdapter",a),egret.registerImplementation("eui.IThemeAdapter",new ThemeAdapter),this.loadingView=new LoadingUI,this.stage.addChild(this.loadingView),RES.addEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),RES.loadConfig("resource/default.res.json","resource/")},t.prototype.onConfigComplete=function(e){RES.removeEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this);var t=new eui.Theme("resource/default.thm.json",this.stage);t.addEventListener(eui.UIEvent.COMPLETE,this.onThemeLoadComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.addEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onItemLoadError,this),RES.loadGroup("preload")},t.prototype.onThemeLoadComplete=function(){this.isThemeLoadEnd=!0,this.createScene()},t.prototype.onResourceLoadComplete=function(e){"preload"==e.groupName&&(this.stage.removeChild(this.loadingView),RES.removeEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.removeEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.removeEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onItemLoadError,this),this.isResourceLoadEnd=!0,this.createScene())},t.prototype.createScene=function(){this.isThemeLoadEnd&&this.isResourceLoadEnd&&this.startCreateScene()},t.prototype.onItemLoadError=function(e){console.warn("Url:"+e.resItem.url+" has failed to load")},t.prototype.onResourceLoadError=function(e){console.warn("Group:"+e.groupName+" has failed to load"),this.onResourceLoadComplete(e)},t.prototype.onResourceProgress=function(e){"preload"==e.groupName?this.loadingView.setProgress(e.itemsLoaded,e.itemsTotal):this.m_oLoadingScene.fSetProgress(e.itemsLoaded/e.itemsTotal)},t.prototype.fKeyBoard=function(e){console.info(e.target.inputs[0])},t.prototype.startCreateScene=function(){console.warn("startCreateScene");new game.Photo;new game.DeskCardDown(null),new game.DeskCardLeft(null),new game.DeskCardRight(null),new game.DeskCardUp(null),new game.Direction,game.Packet.fInitPacketMap();var e=new game.LoadingScene;this.addChild(e),this.m_oGameLayer=new eui.UILayer,this.addChild(this.m_oGameLayer),this.m_oDialogLayer=new eui.Group,this.addChild(this.m_oDialogLayer),game.ShowLayer.fSetDialogLayer(this.m_oDialogLayer),this.m_oLoadingLayer=new eui.Group,this.addChild(this.m_oLoadingLayer),this.m_oLoadingLayer.visible=!1,setTimeout(function(){game.GameScenenManager.fGetIns().fEnterScene(game.GameSceneName.LOGIN)},10)},t.prototype.GetShowTipLayer=function(){return this.m_oDialogLayer},t.prototype.fLoadIngVisible=function(e){this.m_oLoadingLayer.visible=e,e?(this.m_oLoadingScene=new game.LoadingScene,this.m_oLoadingLayer.addChild(this.m_oLoadingScene)):this.m_oLoadingScene&&(this.m_oLoadingScene.parent.removeChild(this.m_oLoadingScene),this.m_oLoadingScene=null)},t.prototype.fLoadResGroup=function(e,t,a){if(!e||""==e)return a&&a.call(null),void this.fLoadIngVisible(!1);this.fLoadIngVisible(!0);var o=this,n=function(t){if(t.groupName==e){RES.removeEventListener(RES.ResourceEvent.GROUP_COMPLETE,n,o),RES.removeEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,o.onResourceLoadError,o),RES.removeEventListener(RES.ResourceEvent.GROUP_PROGRESS,o.onResourceProgress,o),RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,o.onItemLoadError,o),a&&a.call(null);var r=egret.Tween.get(this.m_oLoadingScene);r.wait(500).to({alpha:.1},1e3,egret.Ease.sineIn).call(function(){o.fLoadIngVisible(!1)})}};RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,n,this),RES.addEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.addEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onItemLoadError,this),RES.loadGroup(e)},t}(eui.UILayer);__reflect(Main.prototype,"Main");var ThemeAdapter=function(){function e(){}return e.prototype.getTheme=function(e,t,a,o){function n(e){t.call(o,e)}function r(t){t.resItem.url==e&&(RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,r,null),a.call(o))}RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,r,null),RES.getResByUrl(e,n,this,RES.ResourceItem.TYPE_TEXT)},e}();__reflect(ThemeAdapter.prototype,"ThemeAdapter",["eui.IThemeAdapter"]);var game;!function(e){var t=function(e){function t(t){var a=e.call(this,t)||this;return a.endian=egret.Endian.BIG_ENDIAN,a}return __extends(t,e),t.prototype.fReadLong=function(){var e=this.readInt()<<32;return e+this.readInt()},t.prototype.fWriteLong=function(e){var t=0xffffffff00000000&e,a=4294967295&e;this.writeInt(t),this.writeInt(a)},t}(egret.ByteArray);e.GameByteArray=t,__reflect(t.prototype,"game.GameByteArray")}(game||(game={}));var game;!function(e){var t=function(){function e(){}return e.s_C2S_HEARDBEAT=1,e.s_C2S_LOGIN=101,e.s_C2S_CREATEROOM=102,e.s_C2S_JOINROOM=103,e.s_C2S_ROOMINFO=104,e.s_C2S_Ready=200,e.s_C2S_StartHand=202,e.s_C2S_BASE=300,e.s_C2S_PLAYHAND=304,e.s_C2S_MOPAI=303,e.s_C2S_HU_PAI=302,e.s_C2S_EAT_PAI=308,e.s_C2S_PENG_PAI=307,e.s_C2S_GANG_PAI=306,e.s_C2S_SPEAK=900,e}();e.Protocol=t,__reflect(t.prototype,"game.Protocol")}(game||(game={}));var game;!function(e){var t;!function(e){e[e.e_Hall=0]="e_Hall"}(t=e.SocketServerType||(e.SocketServerType={}));var a=function(a){function o(e){void 0===e&&(e=t.e_Hall);var o=a.call(this)||this;return o.m_bReConnect=!1,o.m_aServerConfig=[{ip:"192.168.1.30",port:"9090/ws?userId="}],o.m_eServerType=e,o.m_nHearBeatId=0,o.fInitModules(),o}return __extends(o,a),o.prototype.fInitModules=function(){this.m_oLoginMoudle=new e.LoginNetMoudle,this.m_oActionMoudle=new e.ActionMoudle,o.s_aProtocols[e.Protocol.s_C2S_HEARDBEAT]=[],o.s_aProtocols[e.Protocol.s_C2S_HEARDBEAT]=[this,this.fOnHeartBeat],this.m_oCreateRoomMoudle=new e.CreateRoomMoudle,this.m_oRoomMoudle=new e.RoomMoudle,this.m_oJoinRoomMoudle=new e.JoinRoomMoudle},o.prototype.fOnHeartBeat=function(e){console.info("心跳")},o.prototype.fOnConnect=function(e){var t=this;console.info("连接 已经成功建立！"),clearInterval(this.m_nHearBeatId),this.m_nHearBeatId=setInterval(function(){t.fSendHeartPkt()},6e3)},o.prototype.fSendHeartPkt=function(){},o.prototype.fSendPkt=function(t){if(this.m_oSocket.connected){console.info("发送数据包"+t.fGetPacketName());var a=new e.GameByteArray,o=t.fWrite();a.writeInt(o.length+2),a.writeBytes(o),this.m_oSocket.writeBytes(a),this.m_oSocket.flush()}else console.info("服务器已经断开连接")},o.prototype.fOnReceiveMessage=function(t){console.info("收到数据包");var a=new e.GameByteArray;if(this.m_oSocket.readBytes(a),a.bytesAvailable>=2){var n=(a.readInt(),a.readShort());console.info("收到数据包, 类型为："+n+"，"+e.Packet.fGetPacketNameById(n)),a.position-=4;var r=e.Packet.fCreatePkt(n);if(null!=r){r.fRead(a);var i=o.s_aProtocols[r.fGetHead().m_nPktType];if(void 0==i)return;i[1].call(i[0],r)}}},o.prototype.fRemoveEvent=function(){this.m_oSocket&&(this.m_oSocket.hasEventListener(egret.Event.CONNECT)&&this.m_oSocket.removeEventListener(egret.Event.CONNECT,this.fOnConnect,this),this.m_oSocket.hasEventListener(egret.ProgressEvent.SOCKET_DATA)&&this.m_oSocket.removeEventListener(egret.ProgressEvent.SOCKET_DATA,this.fOnReceiveMessage,this),this.m_oSocket.hasEventListener(egret.Event.CLOSE)&&this.m_oSocket.removeEventListener(egret.Event.CLOSE,this.fOnClose,this),this.m_oSocket.hasEventListener(egret.IOErrorEvent.IO_ERROR)&&this.m_oSocket.removeEventListener(egret.IOErrorEvent.IO_ERROR,this.fOnSocketError,this))},o.prototype.fCloseSocket=function(){this.m_oSocket&&(this.fRemoveEvent(),this.m_oSocket.close(),this.m_oSocket=null)},o.prototype.fOnSocketError=function(e){this.fOnClose(null)},o.prototype.fOnClose=function(e){this.fRemoveEvent(),this.m_oSocket.connected?"IOS"==egret.Capabilities.os?(this.m_bReConnect=!1,this.fDoReconnect()):(this.m_oSocket.hasEventListener(egret.Event.CLOSE)||this.m_oSocket.addEventListener(egret.Event.CLOSE,this.fOnClose,this),this.m_oSocket.close()):(this.m_bReConnect=!1,this.fDoReconnect()),this.dispatchEvent(new egret.Event("NetError"))},o.prototype.fDoReconnect=function(){1!=this.m_bReConnect&&(this.m_bReConnect=!0,console.info("正在断线重连中..."),this.m_oSocket=new egret.WebSocket,this.m_oSocket.type=egret.WebSocket.TYPE_BINARY,this.m_oSocket.addEventListener(egret.Event.CONNECT,this.fOnConnect,this),this.m_oSocket.addEventListener(egret.ProgressEvent.SOCKET_DATA,this.fOnReceiveMessage,this),this.m_oSocket.addEventListener(egret.Event.CLOSE,this.fOnClose,this),this.m_oSocket.addEventListener(egret.IOErrorEvent.IO_ERROR,this.fOnSocketError,this),this.m_oSocket.connect(this.m_aServerConfig[this.m_eServerType].ip,this.m_aServerConfig[this.m_eServerType].port))},o.prototype.fInitSocket=function(){this.fCloseSocket(),this.m_oSocket=new egret.WebSocket,this.m_oSocket.type=egret.WebSocket.TYPE_BINARY,this.m_oSocket.connect(this.m_aServerConfig[0].ip,this.m_aServerConfig[0].port+e.GameManager.fGetIns().m_sFirstPlayerUid),this.m_oSocket.addEventListener(egret.Event.CONNECT,this.fOnConnect,this),this.m_oSocket.addEventListener(egret.ProgressEvent.SOCKET_DATA,this.fOnReceiveMessage,this),this.m_oSocket.addEventListener(egret.Event.CLOSE,this.fOnClose,this),this.m_oSocket.addEventListener(egret.IOErrorEvent.IO_ERROR,this.fOnSocketError,this)},o.s_aProtocols=[],o}(egret.EventDispatcher);e.GameSocket=a,__reflect(a.prototype,"game.GameSocket")}(game||(game={}));var game;!function(e){var t=function(t){function a(){var a=t.call(this)||this;return a.m_s="",a.m_oHead.m_nPktType=e.Protocol.s_C2S_CREATEROOM,a.m_sActionType=e.Packet.s_CreateRoom,a.m_sRoomId="",a.m_gameName=e.GameName.e_ganYuMj,a.m_gameType=e.GameType.e_createRooom,a.m_nPayStyle=0,a.m_nCircle=4,a.m_pPosition=e.PlayePosition.e_Unknow,a.m_nGameChoice=7,a}return __extends(a,t),a.prototype.fWrite=function(){var e=t.prototype.fWrite.call(this);return e.writeShort(this.m_gameName),e.writeShort(this.m_gameType),e.writeShort(this.m_nPayStyle),e.writeShort(this.m_nCircle),e.writeUTF(this.m_sRoomId),e.writeShort(this.m_pPosition),e.writeShort(this.m_nGameChoice),e},a.prototype.fRead=function(a){t.prototype.fRead.call(this,a),this.m_gameName=a.readShort(),this.m_gameType=a.readShort(),this.m_nPayStyle=a.readShort(),this.m_nCircle=a.readShort(),this.m_sRoomId=a.readUTF(),e.GameManager.fGetIns().m_sRoomId=this.m_sRoomId,this.m_pPosition=a.readShort(),e.GameManager.fGetIns().m_pCreatorPos=this.m_pPosition,e.GameManager.fGetIns().m_pCreatorPos=this.m_pPosition,e.GameManager.fGetIns().fSetCreateRoom(!0),this.m_nGameChoice=a.readShort(),this.fVerifyNumber()},a.prototype.fVerifyNumber=function(){this.m_nPayStyle>=2&&(console.info("C2s_HeartCreateRoomPacket this.m_nPayStyle >= 2, = "+this.m_nPayStyle),alert("C2s_HeartCreateRoomPacket this.m_nPayStyle >= 2, = "+this.m_nPayStyle)),this.m_gameType!=e.GameType.e_createRooom&&(console.info("C2s_HeartCreateRoomPacket this.m_gameType != e_createRooom, = "+this.m_gameType),alert("C2s_HeartCreateRoomPacket this.m_gameType != e_createRooom, = "+this.m_gameType))},a}(e.Packet);e.C2s_CreateRoomPacket=t,__reflect(t.prototype,"game.C2s_CreateRoomPacket")}(game||(game={}));var game;!function(e){var t=function(t){function a(){var o=t.call(this)||this;return o.m_oHead.m_nPktType=e.Protocol.s_C2S_HEARDBEAT,a.s_nNumber++,o}return __extends(a,t),a.prototype.fRead=function(e){t.prototype.fRead.call(this,e);var o=e.fReadLong();o<a.s_nNumber&&console.warn("心跳包丢失,发送个数"+a.s_nNumber+"接收个数"+o)},a.prototype.fWrite=function(){var e=t.prototype.fWrite.call(this);return e.fWriteLong(a.s_nNumber),e},a.s_nNumber=0,a}(e.Packet);e.C2s_HeartBeat=t,__reflect(t.prototype,"game.C2s_HeartBeat")}(game||(game={}));var game;!function(e){var t=function(t){function a(){var a=t.call(this)||this;return a.m_oHead.m_nPktType=e.Protocol.s_C2S_JOINROOM,a.m_sActionType=e.Packet.s_JoinRoom,a.m_gameType=1,a}return __extends(a,t),a.prototype.fWrite=function(){var e=t.prototype.fWrite.call(this);return e.writeShort(this.m_gameName),e.writeShort(this.m_gameType),e.writeUTF(this.m_sRoomId),e},a.prototype.fRead=function(e){t.prototype.fRead.call(this,e),this.m_gameName=e.readShort(),this.m_gameType=e.readShort(),this.m_sRoomId=e.readUTF(),this.fVerifyNumber()},a.prototype.fVerifyNumber=function(){this.m_gameType!=e.GameType.e_joinRoom&&(console.info("C2s_JoinRoomPacket this.m_gameType != e_joinRoom, = "+this.m_gameType),alert("C2s_JoinRoomPacket this.m_gameType != e_joinRoom, = "+this.m_gameType))},a}(e.Packet);e.C2s_JoinRoomPacket=t,__reflect(t.prototype,"game.C2s_JoinRoomPacket")}(game||(game={}));var game;!function(e){var t=function(t){function a(){var a=t.call(this)||this;return a.m_oHead.m_nPktType=e.Protocol.s_C2S_LOGIN,a.m_sActionType=e.Packet.s_Login,a}return __extends(a,t),a.prototype.fRead=function(a){t.prototype.fRead.call(this,a);var o=a.readUTF();Utils.fNotUsefunData(o)&&console.warn("NotUserfunData");var n=a.readShort();e.GameManager.fGetIns().m_oGameBaseInfo.m_nLoginType=n,Utils.fNotUsefunData(n)&&console.warn("NotUserfunData")},a.prototype.fWrite=function(){var a=t.prototype.fWrite.call(this),o=e.GameManager.fGetIns().m_oGameBaseInfo.m_nLoginType;return Utils.fNotUsefunData(o)&&console.warn("NotUserfunData"),a.writeShort(o),a},a}(e.Packet);e.C2s_GameLogin=t,__reflect(t.prototype,"game.C2s_GameLogin")}(game||(game={}));var game;!function(e){var t=function(t){function a(){var a=t.call(this)||this;return a.m_aReadyPos=[],a.m_oHead.m_nPktType=e.Protocol.s_C2S_Ready,a.m_sActionType=e.Packet.s_PlayerReady,a
}return __extends(a,t),a.prototype.fRead=function(e){t.prototype.fRead.call(this,e),this.m_nReadyNum=e.readShort();for(var a=0;a<this.m_nReadyNum;a++){var o=e.readShort();this.m_aReadyPos.push(o)}},a.prototype.fWrite=function(){var e=t.prototype.fWrite.call(this);e.writeShort(this.m_nReadyNum);for(var a=0;a<this.m_nReadyNum;a++)e.writeShort(this.m_aReadyPos[a]);return e},a}(e.Packet);e.S2C_ReadyActive=t,__reflect(t.prototype,"game.S2C_ReadyActive")}(game||(game={}));var game;!function(e){var t=function(t){function a(){var a=t.call(this)||this;a.m_aDice=[],a.m_aPlayerInfo=[],a.m_aPlay=[],a.m_nGameChoice=7,a.m_oHead.m_nPktType=e.Protocol.s_C2S_ROOMINFO,a.m_sActionType=e.Packet.s_RoomInfo;for(var o=e.PlayePosition.e_Up;o<=e.PlayePosition.e_Right;o++)a.m_aPlay[o]=new e.Player(o);return a}return __extends(a,t),a.prototype.fGetUserInfoByPos=function(e){for(var t in this.m_aPlayerInfo)if(this.m_aPlayerInfo[t].m_pPosition==e)return this.m_aPlayerInfo[t]},a.prototype.fCancelUserReadyStatus=function(){for(var e in this.m_aPlayerInfo)this.m_aPlayerInfo[e].m_nStatus=0},a.prototype.fRead=function(a){t.prototype.fRead.call(this,a),this.m_gameName=a.readShort(),this.m_nPayStyle=a.readShort(),this.m_nCircle=a.readShort(),this.m_nNowCircle=a.readShort(),this.m_sRoomId=a.readUTF(),this.m_aDice[0]=a.readShort(),this.m_aDice[1]=a.readShort(),this.m_nPlayerNum=a.readShort(),this.m_nBankerPos=a.readShort(),e.GameManager.fGetIns().m_sRoomId=this.m_sRoomId,e.GameManager.fGetIns().m_pBankerPos=this.m_nBankerPos;for(var o=0;o<this.m_nPlayerNum;o++)this.m_aPlayerInfo[o]=new e.C2s_UserInfoPacket,this.m_aPlayerInfo[o].fRead(a,!1);for(var n in this.m_aPlayerInfo){this.m_aPlayerInfo[n].m_sUid==e.GameManager.fGetIns().m_sFirstPlayerUid&&(e.GameManager.fGetIns().m_pFirstPlayerPos=this.m_aPlayerInfo[n].m_pPosition);var r=new e.BaseUserInfo;r.m_sUid=this.m_aPlayerInfo[n].m_sUid,r.m_nStatus=this.m_aPlayerInfo[n].m_nStatus,r.m_pDeskPos=this.m_aPlayerInfo[n].m_pPosition,e.GameManager.fGetIns().fPushPlayerInfo(r)}e.GameManager.fGetIns().m_pCreatorPos=e.PlayePosition.e_Right,e.GameManager.fGetIns().fSetFirstPos(this),this.m_nGameChoice=a.readShort()},a.prototype.fAddCardByPos=function(t,a){for(var o=0;o<this.m_aPlayerInfo.length;o++)if(this.m_aPlayerInfo[o].m_pPosition==a)for(var n=0;n<this.m_aPlayerInfo[o].m_aPlayCardGroup.length;n++)this.m_aPlayerInfo[o].m_aPlayCardGroup[n].m_oCardStatus.m_nStatusType==e.CardStatus.s_Status_Hand&&e.CardBase.fInsetCard(t,this.m_aPlayerInfo[o].m_aPlayCardGroup[n].fGetCard())},a.prototype.fWrite=function(){var e=t.prototype.fWrite.call(this);e.writeShort(this.m_gameName),e.writeShort(this.m_nPayStyle),e.writeShort(this.m_nCircle),e.writeShort(this.m_nNowCircle),e.writeUTF(this.m_sRoomId),e.writeShort(this.m_aDice[0]),e.writeShort(this.m_aDice[1]),e.writeShort(this.m_nPlayerNum),e.writeShort(this.m_nBankerPos);for(var a=0;a<this.m_nPlayerNum;a++)this.m_aPlayerInfo[a].fWrite_0(e);return e.writeShort(this.m_nGameChoice),e},a}(e.Packet);e.C2s_RoomInfoPacket=t,__reflect(t.prototype,"game.C2s_RoomInfoPacket")}(game||(game={}));var game;!function(e){var t=function(t){function a(){var a=t.call(this)||this;return a.m_nVoiceCount=0,a.m_aVoice=[],a.m_oHead.m_nPktType=e.Protocol.s_C2S_SPEAK,a.m_sActionType=e.Packet.s_Speak,a}return __extends(a,t),a.prototype.fSetVoice=function(e){for(console.info("xuwei: str.length = "+e.length);e.length>=3e4;)this.m_aVoice[this.m_nVoiceCount]=e.slice(0,3e4),e=e.slice(3e4,e.length),this.m_nVoiceCount++;this.m_aVoice[this.m_nVoiceCount++]=e,console.info("xuwei: m_nVoiceCount = "+this.m_nVoiceCount)},a.prototype.fWrite=function(){var e=t.prototype.fWrite.call(this);e.writeShort(this.m_nVoiceCount);for(var a=0;a<this.m_nVoiceCount;a++)e.writeUTF(this.m_aVoice[a]);return e},a.prototype.fRead=function(e){t.prototype.fRead.call(this,e),this.m_nVoiceCount=e.readShort(),console.info("xuwei: fRead = "+this.m_nVoiceCount);for(var a=0;a<this.m_nVoiceCount;a++)this.m_aVoice[a]=e.readUTF(),console.info("xuwei: fRead = "+this.m_aVoice[a])},a}(e.Packet);e.C2s_SpeakPacket=t,__reflect(t.prototype,"game.C2s_SpeakPacket")}(game||(game={}));var game;!function(e){var t=function(t){function a(){var a=t.call(this)||this;return a.m_aPlayCardGroup=[],a.m_oHead.m_nPktType=e.Protocol.s_C2S_ROOMINFO,a.m_sActionType=e.Packet.s_RoomInfo,a.m_pPosition=e.PlayePosition.e_Unknow,a}return __extends(a,t),a.prototype.fGetHandCardGop=function(){for(var t in this.m_aPlayCardGroup)if(this.m_aPlayCardGroup[t].m_oCardStatus.m_nStatusType==e.CardStatus.s_Status_Hand)return this.m_aPlayCardGroup[t]},a.prototype.fRead=function(a,o){void 0===o&&(o=!0),o&&t.prototype.fRead.call(this,a),this.m_sUid=a.readUTF(),this.m_sUserName=a.readUTF(),this.m_nVipDegree=a.readShort(),this.m_sUserIcon=a.readUTF(),this.m_nStatus=a.readShort(),this.m_pPosition=a.readShort(),this.m_nGroupNum=a.readShort();for(var n=0;n<this.m_nGroupNum;n++){var r=new e.CardGroup;r.fRead(a),this.m_aPlayCardGroup.push(r)}this.fVerifyNumber()},a.prototype.fWrite_0=function(e){return null},a.prototype.fVerifyNumber=function(){},a}(e.Packet);e.C2s_UserInfoPacket=t,__reflect(t.prototype,"game.C2s_UserInfoPacket")}(game||(game={}));var AssetAdapter=function(){function e(){}return e.prototype.getAsset=function(e,t,a){function o(o){t.call(a,o,e)}if(RES.hasRes(e)){var n=RES.getRes(e);n?o(n):RES.getResAsync(e,o,this)}else RES.getResByUrl(e,o,this,RES.ResourceItem.TYPE_IMAGE)},e}();__reflect(AssetAdapter.prototype,"AssetAdapter",["eui.IAssetAdapter"]);var game;!function(e){var t=function(){function e(){this.m_nStatusType=-1,this.m_nTime=-1}return e.prototype.fRead=function(e){this.m_nStatusType=e.readShort(),this.m_nTime=e.fReadLong()},e.prototype.fWrite=function(e){return e.writeShort(this.m_nStatusType),e.fWriteLong(this.m_nTime),e},e.s_Status_Desktop=0,e.s_Status_Hand=1,e.s_Status_Mo=2,e.s_Status_Launch=3,e.s_Status_Eat=4,e.s_Status_Peng=5,e.s_Status_Gang=6,e.s_Status_Hua=7,e.s_Status_Hu=8,e}();e.CardStatus=t,__reflect(t.prototype,"game.CardStatus");var a=function(){function a(){this.m_aCards=[],this.m_oCardStatus=new t}return a.prototype.fRead=function(t){this.m_pBelong=t.readShort(),this.m_nCardsCount=t.readShort();for(var a=0;a<this.m_nCardsCount;a++){var o=new e.CardBase(-1,-1,-1);o.fRead(t),this.m_aCards.push(o)}this.m_oCardStatus.fRead(t)},a.prototype.fWrite=function(e){e.writeShort(this.m_pBelong),e.writeShort(this.m_nCardsCount);for(var t=0;t<this.m_nCardsCount;t++)this.m_aCards[t].fWrite(e);this.m_oCardStatus.fWrite(e)},a.prototype.fPushCard=function(e){this.m_aCards.push(e)},a.prototype.fGetCard=function(){return this.m_aCards},a.prototype.fSetCards=function(e){this.m_aCards=e},a.prototype.fSplicCard=function(e){var t=0;for(var a in this.m_aCards)e.fGetType()==this.m_aCards[a].fGetType()&&e.fGetValue()==this.m_aCards[a].fGetValue()&&e.m_nPriority==this.m_aCards[a].m_nPriority&&(this.m_aCards.splice(t,1),this.m_nCardsCount--),t++},a.prototype.fInitSort=function(){var e,t,a;for(e=1;e<this.m_aCards.length;e++){for(a=this.m_aCards[e],t=e;t>0&&this.m_aCards[t-1].m_nPriority>a.m_nPriority;t--)this.m_aCards[t]=this.m_aCards[t-1];this.m_aCards[t]=a}},a}();e.CardGroup=a,__reflect(a.prototype,"game.CardGroup")}(game||(game={}));var game;!function(e){var t=function(t){function a(){var a=t.call(this)||this;return a.m_aDiceNum=[],a.m_aCardGroup=[],a.m_oHead.m_nPktType=e.Protocol.s_C2S_StartHand,a.m_sActionType=e.Packet.s_BeginGame,a.m_aDiceNum[0]=-1,a.m_aDiceNum[1]=-1,a.m_nStartCardsNum=-1,a.m_nStartGroupNum=0,a}return __extends(a,t),a.prototype.fWrite=function(){var e=t.prototype.fWrite.call(this);return e.writeShort(this.m_aDiceNum[0]),e.writeShort(this.m_aDiceNum[1]),e.writeShort(this.m_nStartCardsNum),e.writeShort(this.m_nStartGroupNum),e},a.prototype.fRead=function(a){t.prototype.fRead.call(this,a),this.m_aDiceNum[0]=a.readShort(),this.m_aDiceNum[1]=a.readShort(),this.m_nStartCardsNum=a.readShort(),this.m_nStartGroupNum=a.readShort();for(var o=0;o<this.m_nStartGroupNum;o++){var n=new e.CardGroup;n.fRead(a),this.m_aCardGroup.push(n)}e.GameManager.fGetIns().m_nPlayerActionPos=e.PlayePosition.e_Right,e.GameManager.fGetIns().m_nInitPlayerCardNum=this.m_aCardGroup[0].m_nCardsCount,e.GameManager.fGetIns().m_nAllCardsNum=this.m_nStartCardsNum,e.GameManager.fGetIns().m_oGameBaseInfo.m_aDiceNum=this.m_aDiceNum;for(var o=0;o<this.m_aCardGroup.length;o++)if(this.m_aCardGroup[o].m_pBelong==e.GameManager.fGetIns().m_pFirstPlayerPos)for(var r=this.m_aCardGroup[o].fGetCard(),i=0;i<r.length;i++)e.GameManager.fGetIns().m_aHandCardsDown.push(new e.HandCardDown(r[i]));this.fVerifyNumber()},a.prototype.fVerifyNumber=function(){},a}(e.Packet);e.C2s_BeginGamePacket=t,__reflect(t.prototype,"game.C2s_BeginGamePacket")}(game||(game={}));var game;!function(e){var t=function(t){function a(){var a=t.call(this)||this;return a.m_oHead.m_nPktType=e.Protocol.s_C2S_EAT_PAI,a.m_sActionType=e.Packet.s_Eat,a}return __extends(a,t),a.prototype.fWrite=function(){var e=t.prototype.fWrite.call(this);return e},a.prototype.fRead=function(e){t.prototype.fRead.call(this,e),this.fVerifyNumber()},a.prototype.fVerifyNumber=function(){},a}(e.C2s_ActionBase);e.C2s_EatAction=t,__reflect(t.prototype,"game.C2s_EatAction")}(game||(game={}));var game;!function(e){var t=function(t){function a(){var a=t.call(this)||this;return a.m_oHead.m_nPktType=e.Protocol.s_C2S_GANG_PAI,a.m_sActionType=e.Packet.s_Gang,a}return __extends(a,t),a.prototype.fWrite=function(){var e=t.prototype.fWrite.call(this);return e},a.prototype.fRead=function(e){t.prototype.fRead.call(this,e),this.fVerifyNumber()},a.prototype.fVerifyNumber=function(){},a}(e.C2s_ActionBase);e.C2s_GangAction=t,__reflect(t.prototype,"game.C2s_GangAction")}(game||(game={}));var game;!function(e){var t=function(t){function a(){var a=t.call(this)||this;return a.m_oHead.m_nPktType=e.Protocol.s_C2S_PENG_PAI,a.m_sActionType=e.Packet.s_Peng,a}return __extends(a,t),a.prototype.fWrite=function(){var e=t.prototype.fWrite.call(this);return e},a.prototype.fRead=function(e){t.prototype.fRead.call(this,e),this.fVerifyNumber()},a.prototype.fVerifyNumber=function(){},a}(e.C2s_ActionBase);e.C2s_PengAction=t,__reflect(t.prototype,"game.C2s_PengAction")}(game||(game={}));var LoadingUI=function(e){function t(){var t=e.call(this)||this;return t.createView(),t}return __extends(t,e),t.prototype.createView=function(){this.textField=new egret.TextField,this.addChild(this.textField),this.textField.y=300,this.textField.width=480,this.textField.height=100,this.textField.textAlign="center"},t.prototype.setProgress=function(e,t){this.textField.text="Loading..."+e+"/"+t},t}(egret.Sprite);__reflect(LoadingUI.prototype,"LoadingUI");var game;!function(e){var t=function(t){function a(){var a=t.call(this)||this;return a.m_oHead.m_nPktType=e.Protocol.s_C2S_MOPAI,a.m_sActionType=e.Packet.s_Touch,a}return __extends(a,t),a.prototype.fWrite=function(){var e=t.prototype.fWrite.call(this);return e},a.prototype.fRead=function(a){if(t.prototype.fRead.call(this,a),e.GameManager.fGetIns().m_nPlayerActionPos=this.m_pCurrentPlayer,this.fGetBelongPlayerPos()==this.fGetCurrPlayrPos()){var o=this.m_aGroupCards[0].fGetCard()[0];e.GameManager.fGetIns().m_oTouchHandCard=new e.HandCardDown(o)}this.fVerifyNumber()},a.prototype.fVerifyNumber=function(){},a}(e.C2s_ActionBase);e.C2s_TouchPacket=t,__reflect(t.prototype,"game.C2s_TouchPacket")}(game||(game={}));var game;!function(e){var t=function(e){function t(){var t=e.call(this)||this;return t.isPressed=!1,t.once(egret.Event.ADDED_TO_STAGE,t.fOnUICreate,t),t}return __extends(t,e),t.prototype.fOnUICreate=function(){if(this.m_sImageUse){var e=this.getChildAt(0);e&&(e.source=this.m_sImageUse)}Utils.fResetAnchor(this),this.includeInLayout=!1,this.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.fOnBegin,this),this.addEventListener(egret.TouchEvent.TOUCH_END,this.fOnEnd,this);var t=Utils.fGetAncestor(this);t.addEventListener(egret.TouchEvent.TOUCH_MOVE,this.fOnMove,this),this.addEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,this.fOnOutSide,this)},t.prototype.fSetImage=function(e){this.m_sImageUse=e;var t=this.getChildAt(0);t&&(t.source=this.m_sImageUse)},t.prototype.fRelease=function(){this.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,this.fOnBegin,this),this.removeEventListener(egret.TouchEvent.TOUCH_END,this.fOnEnd,this);var e=Utils.fGetAncestor(this);e.removeEventListener(egret.TouchEvent.TOUCH_MOVE,this.fOnMove,this),this.removeEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,this.fOnOutSide,this)},t.prototype.fOnBegin=function(){this.fSetPressed(!0)},t.prototype.fOnEnd=function(){this.isPressed&&this.m_oListenerBind&&this.m_oListenerBind.fOnClick(this),this.fOnTouchRelease()},t.prototype.fOnMove=function(e){var t=this.hitTestPoint(e.stageX,e.stageY);t||this.fOnTouchRelease()},t.prototype.fOnOutSide=function(){this.fOnTouchRelease()},t.prototype.fOnTouchRelease=function(){this.fSetPressed(!1)},t.prototype.fSetPressed=function(e){this.isPressed=e;var t=1;this.isPressed&&(t=1.05),this.scaleX=t,this.scaleY=t},t.prototype.fBindListener=function(e){this.m_oListenerBind=e},t}(eui.Button);e.Button=t,__reflect(t.prototype,"game.Button")}(game||(game={}));var game;!function(e){var t=function(e){function t(t,a){var o=e.call(this)||this;return o.skinName="resource/gameSkins/HandCardDown.exml",o.once(eui.UIEvent.COMPLETE,o.fOnUICreate,o),o.m_oCardBuf=a,o.m_labValue.text=t,o}return __extends(t,e),t.prototype.fOnUICreate=function(){},t}(eui.Component);e.Card=t,__reflect(t.prototype,"game.Card");var a=function(e){function t(t,a){var o=e.call(this)||this;return o.skinName="resource/gameSkins/HandCardLeft.exml",o.once(eui.UIEvent.COMPLETE,o.fOnUICreate,o),o.m_oCardBuf=a,o}return __extends(t,e),t.prototype.fOnUICreate=function(){},t}(eui.Component);e.CardLeft=a,__reflect(a.prototype,"game.CardLeft");var o=function(e){function t(t,a){var o=e.call(this)||this;return o.skinName="resource/gameSkins/HandCardUp.exml",o.once(eui.UIEvent.COMPLETE,o.fOnUICreate,o),o.m_oCardBuf=a,o}return __extends(t,e),t.prototype.fOnUICreate=function(){},t}(eui.Component);e.CardUp=o,__reflect(o.prototype,"game.CardUp");var n=function(e){function t(t,a){var o=e.call(this)||this;return o.skinName="resource/gameSkins/HandCardRight.exml",o.once(eui.UIEvent.COMPLETE,o.fOnUICreate,o),o.m_oCardBuf=a,o}return __extends(t,e),t.prototype.fOnUICreate=function(){},t}(eui.Component);e.CardRight=n,__reflect(n.prototype,"game.CardRight")}(game||(game={}));var game;!function(e){var t;!function(e){e[e.TYPE_ZOOM=0]="TYPE_ZOOM",e[e.TYPE_DROP=1]="TYPE_DROP"}(t=e.DIALOG_PLAYTYPE||(e.DIALOG_PLAYTYPE={}));var a=function(e){function a(){var t=e.call(this)||this;return t.offsetX=0,t.offsetY=0,t}return __extends(a,e),a.fSetDialogLayer=function(e){a.defaultLayer=e},a.prototype.fSetOffset=function(e,t){this.offsetX=e,this.offsetY=t},a.prototype.fShow=function(e){this.dialogLayer=a.defaultLayer,e&&(this.dialogLayer=e),this.anchorOffsetX=this.width/2,this.anchorOffsetY=this.height/2,this.x=512-this.offsetX,this.y=301-this.offsetY,a.fAddDialog(this,this.dialogLayer)},a.prototype.fShowPlay=function(e,a){switch(this.fShow(a),e){case t.TYPE_ZOOM:this.fPlayAnimationZoom();break;case t.TYPE_DROP:this.fPlayAnimationDrop()}},a.prototype.fPlayAnimationZoom=function(e){this.scaleY=.1;var t=egret.Tween.get(this);t.to({scaleY:1.1},150,egret.Ease.getPowIn(2)),t.to({scaleY:1},150,egret.Ease.getPowIn(2)),e&&t.call(e)},a.prototype.fPlayAnimationDrop=function(e){var t=this.y;this.y=-this.height/2;var a=egret.Tween.get(this);a.to({y:t},200,egret.Ease.getPowIn(2)),a.to({y:t-20},100,egret.Ease.getPowOut(2)),a.to({y:t},100,egret.Ease.getPowOut(2)),e&&a.call(e)},a.prototype.fExit=function(){a.removeDialog(this,this.dialogLayer)},a.fAddDialog=function(e,t){var a=new eui.Image("global_ui_dialog_bg_png");a.width=480,a.height=800,a.touchEnabled=!0,t.addChild(a),e.bgMask=a,t.addChild(e)},a.removeDialog=function(e,t){e.fRelease(),t.contains(e)&&(t.removeChild(e.bgMask),t.removeChild(e))},a.fHasDialog=function(){return a.defaultLayer.numElements>0},a}(e.Scene);e.ShowLayer=a,__reflect(a.prototype,"game.ShowLayer")}(game||(game={}));var game;!function(e){var t=function(){function t(){e.GameSocket.s_aProtocols[e.Protocol.s_C2S_PLAYHAND]=[this,this.fPlayHand],e.GameSocket.s_aProtocols[e.Protocol.s_C2S_CREATEROOM]=[this,this.fCreateRoom],e.GameSocket.s_aProtocols[e.Protocol.s_C2S_MOPAI]=[this,this.fCreateRoom],e.GameSocket.s_aProtocols[e.Protocol.s_C2S_EAT_PAI]=[this,this.fCreateRoom],e.GameSocket.s_aProtocols[e.Protocol.s_C2S_PENG_PAI]=[this,this.fCreateRoom],e.GameSocket.s_aProtocols[e.Protocol.s_C2S_GANG_PAI]=[this,this.fCreateRoom],this.m_oHandle=new e.Handle}return t.prototype.fPlayHand=function(e){this.m_oHandle.fSendMessage(e.fGetActionType(),e)},t.prototype.fReady=function(e){this.m_oHandle.fSendMessage(e.fGetActionType())},t.prototype.fLaunchPai=function(e){this.m_oHandle.fSendMessage(e.fGetActionType(),e)},t.prototype.fCreateRoom=function(e){this.m_oHandle.fSendMessage(e.fGetActionType(),e)},t.prototype.fDispatchPkt=function(e,t){},t}();e.ActionMoudle=t,__reflect(t.prototype,"game.ActionMoudle")}(game||(game={}));var game;!function(e){var t=function(){function t(){e.GameSocket.s_aProtocols[e.Protocol.s_C2S_CREATEROOM]=[this,this.fCreateRoom],e.GameSocket.s_aProtocols[e.Protocol.s_C2S_SPEAK]=[this,this.fCreateRoom],this.m_oHandle=new e.Handle}return t.prototype.fSpeak=function(e){this.m_oHandle.fSendMessage(e.fGetActionType(),e)},t.prototype.fCreateRoom=function(t){e.GameManager.fGetIns().m_oGameBaseInfo.m_gameName=t.m_gameName,e.GameManager.fGetIns().m_oGameBaseInfo.m_gameType=t.m_gameType,e.GameManager.fGetIns().m_oGameBaseInfo.m_nPayStyle=t.m_nPayStyle,e.GameManager.fGetIns().m_oGameBaseInfo.m_nCircle=t.m_nCircle,e.GameManager.fGetIns().m_sRoomId=t.m_sRoomId;var a=new e.BaseUserInfo;a.m_sUid=e.GameManager.fGetIns().m_sFirstPlayerUid,a.m_nStatus=0,a.m_pDeskPos=e.GameManager.fGetIns().m_pCreatorPos,e.GameManager.fGetIns().fGetPlayerInfo()[a.m_pDeskPos]=a,this.m_oHandle.fSendMessage(t.fGetActionType(),t)},t}();e.CreateRoomMoudle=t,__reflect(t.prototype,"game.CreateRoomMoudle")}(game||(game={}));var game;!function(e){var t=function(){function t(){e.GameSocket.s_aProtocols[e.Protocol.s_C2S_JOINROOM]=[this,this.fJoinRoom],this.m_oHandle=new e.Handle}return t.prototype.fJoinRoom=function(e){this.m_oHandle.fSendMessage(e.fGetActionType(),e)},t}();e.JoinRoomMoudle=t,__reflect(t.prototype,"game.JoinRoomMoudle")}(game||(game={}));var game;!function(e){var t=function(){function t(){e.GameSocket.s_aProtocols[e.Protocol.s_C2S_LOGIN]=[this,this.fOnLogin],this.m_oHandle=new e.Handle}return t.prototype.fOnLogin=function(e){},t}();e.LoginNetMoudle=t,__reflect(t.prototype,"game.LoginNetMoudle")}(game||(game={}));var game;!function(e){var t=function(){function t(){e.GameSocket.s_aProtocols[e.Protocol.s_C2S_ROOMINFO]=[this,this.fRoom],e.GameSocket.s_aProtocols[e.Protocol.s_C2S_Ready]=[this,this.fRoom],e.GameSocket.s_aProtocols[e.Protocol.s_C2S_StartHand]=[this,this.fRoom],this.m_oHandle=new e.Handle}return t.prototype.fRoom=function(e){this.m_oHandle.fSendMessage(e.fGetActionType(),e)},t.prototype.fReadyActive=function(e){this.m_oHandle.fSendMessage(e.fGetActionType(),e)},t}();e.RoomMoudle=t,__reflect(t.prototype,"game.RoomMoudle")}(game||(game={}));var game;!function(e){var t=function(){function t(){this.m_oCards=[],this.m_oCards=[],console.info("gs")}return t.fGetIns=function(){return t.s_ins||(t.s_ins=new t),t.s_ins},t.prototype.fClear=function(){this.m_oCards=[],this.m_oDeskTopCardGroup=null,this.m_oDownCardGroup=null,this.m_oLeftCardGroup=null,this.m_oRightCardGroup=null,this.m_oUpCardGroup=null},t.prototype.fPushCard=function(t,a){this.m_oCards.push(t),e.PlayePosition.e_Desktop&&this.m_oDeskTopCardGroup.fPushCard(t)},t.prototype.fSplicCard=function(e){var t=0;for(var a in this.m_oCards)e.fGetType()==this.m_oCards[a].fGetType()&&e.fGetValue()==this.m_oCards[a].fGetValue()&&this.m_oCards.splice(t,1),t++},t}();e.GameCardManager=t,__reflect(t.prototype,"game.GameCardManager")}(game||(game={}));var game;!function(e){var t;!function(e){e[e.e_xinPuMj=0]="e_xinPuMj",e[e.e_ganYuMj=1]="e_ganYuMj"}(t=e.GameName||(e.GameName={}));var a;!function(e){e[e.e_createRooom=0]="e_createRooom",e[e.e_joinRoom=1]="e_joinRoom"}(a=e.GameType||(e.GameType={}));var o=function(){function e(){}return e}();e.BaseUserInfo=o,__reflect(o.prototype,"game.BaseUserInfo");var n=function(){function e(){this.m_aDiceNum=[]}return e}();e.GameBaseInfo=n,__reflect(n.prototype,"game.GameBaseInfo");var r=function(){function e(){this.m_oGameBaseInfo=new n,this.m_aHandCardsDown=[],this.m_aPlayerInfo=[],this.m_bCreateRoom=!1,this.m_aPackets=[]}return e.fGetIns=function(){return e.s_ins||(e.s_ins=new e),e.s_ins},e.prototype.fIsCreateGame=function(){return this.m_bCreateRoom},e.prototype.fSetCreateRoom=function(e){this.m_bCreateRoom=e},e.prototype.fResetByRoomInfoPacket=function(t){this.m_sRoomId=t.m_sRoomId;var a=t.m_aPlayerInfo;for(var n in a)a[n].m_sUid==e.fGetIns().m_sFirstPlayerUid&&(this.m_pFirstPlayerPos=a[n].m_pPosition);for(var n in a){var r=new o;r.m_sUid=a[n].m_sUid,r.m_nStatus=a[n].m_nStatus,this.m_aPlayerInfo.push(r)}},e.prototype.fSetFirstPos=function(t){for(var a in t.m_aPlayerInfo)void 0!=t.m_aPlayerInfo[a]&&t.m_aPlayerInfo[a].m_sUid==e.fGetIns().m_sFirstPlayerUid&&(e.fGetIns().m_pFirstPlayerPos=t.m_aPlayerInfo[a].m_pPosition)},e.prototype.fGetPlayerInfo=function(){return this.m_aPlayerInfo},e.prototype.fPushPlayerInfo=function(e){for(var t in this.m_aPlayerInfo)if(parseInt(t)==e.m_pDeskPos)return;this.m_aPlayerInfo[e.m_pDeskPos]=e},e.s_ReadyCancel=104,e}();e.GameManager=r,__reflect(r.prototype,"game.GameManager")}(game||(game={}));var game;!function(e){var t=function(t){function o(){return t.call(this)||this}return __extends(o,t),o.fGetIns=function(){return o.s_Ins||(o.s_Ins=new o),o.s_Ins},o.prototype.fEnterScene=function(e){var t=this.fGetTopScene();t!=e&&this.fAddScene(e),this.fChangeToScene(e)},o.prototype.fChangeToScene=function(e,t,a){void 0===t&&(t=!0),void 0===a&&(a=!0);var n=Main.fGetIns();n.GetShowTipLayer().removeChildren();var r=this.m_oCurrentScene;r&&a&&(r.parent.removeChild(r),r.fRelease()),this.m_oCurrentScene=o.fCreateScene(e);var i=this,s=function(){if(n.m_oGameLayer.addChild(i.m_oCurrentScene),r&&t){i.m_oCurrentScene.alpha=0;var e=egret.Tween.get(i.m_oCurrentScene);e.wait(800).to({alpha:1},1e3,egret.Ease.sineIn)}};if(a)n.fLoadResGroup(this.m_oCurrentScene.fSceneResGroup(),!0,s);else{var _=egret.Tween.get(r);_.wait(500).to({alpha:.1},1e3,egret.Ease.sineIn).call(function(){r.parent.removeChild(r),r.fRelease()}),s()}},o.prototype.fBackToLastScene=function(){this.fGetSceneStackLength()>1&&(this.fPop(),this.fChangeToScene(this.fGetTopScene(),!0,!1))},o.prototype.fGetCurrentGameScene=function(){return this.fGetTopScene()},o.fCreateScene=function(t){var o;switch(t){case a.LOGIN:o=new e.LoginScene;break;case a.LOG:o=new e.LoginScene;break;case a.HALL:o=new e.HallScene;break;case a.MAIN:o=new e.MainScene;break;default:alert("fCreateScene fail "+t)}return o},o}(e.SceneManager);e.GameScenenManager=t,__reflect(t.prototype,"game.GameScenenManager");var a;!function(e){e[e.LOGIN=0]="LOGIN",e[e.HALL=1]="HALL",e[e.MAIN=2]="MAIN",e[e.LOG=3]="LOG"}(a=e.GameSceneName||(e.GameSceneName={}))}(game||(game={}));var game;!function(e){var t=function(e){function t(t){var a=e.call(this)||this;return a.m_sTipText=t,a.skinName="resource/gameSkins/layer/ShowTip.exml",a}return __extends(t,e),t.fShow=function(e){new t(e)},t.prototype.fOnUICreate=function(){this.m_labTip.text=this.m_sTipText,this.fSetClickButton(this)},t.prototype.fOnClick=function(e){this.parent.removeChild(this)},t}(e.Scene);e.TipShow=t,__reflect(t.prototype,"game.TipShow")}(game||(game={}));var game;!function(e){var t=function(t){function a(a,o,n){var r=t.call(this,a,o,n)||this;return e.CardBase.s_Value_Feng_Dong==o?r.m_sName="东风":e.CardBase.s_Value_Feng_Xi==o?r.m_sName="西风":e.CardBase.s_Value_Feng_Nan==o?r.m_sName="南风":e.CardBase.s_Value_Feng_Bei?r.m_sName="北风":e.TipShow.fShow("FengCard 创建失败:value ="+o),r}return __extends(a,t),a}(e.CardBase);e.FengCard=t,__reflect(t.prototype,"game.FengCard")}(game||(game={}));var game;!function(e){var t=function(e){function t(t){var a=e.call(this,t)||this;return a.skinName="resource/mjSkins/comp/DeskCardDown.exml",a}return __extends(t,e),t.prototype.fOnUICreate=function(){},t.prototype.fOnClick=function(e){},t}(e.DeskCard);e.DeskCardDown=t,__reflect(t.prototype,"game.DeskCardDown")}(game||(game={}));var game;!function(e){var t=function(e){function t(t){var a=e.call(this,t)||this;return a.skinName="resource/mjSkins/comp/DeskCardLeft.exml",a}return __extends(t,e),t.prototype.fOnUICreate=function(){this.rotation},t.prototype.fOnClick=function(e){},t}(e.DeskCard);e.DeskCardLeft=t,__reflect(t.prototype,"game.DeskCardLeft")}(game||(game={}));var game;!function(e){var t=function(e){function t(t){var a=e.call(this,t)||this;return a.skinName="resource/mjSkins/comp/DeskCardRight.exml",a}return __extends(t,e),t.prototype.fOnUICreate=function(){this.rotation},t.prototype.fOnClick=function(e){},t}(e.DeskCard);e.DeskCardRight=t,__reflect(t.prototype,"game.DeskCardRight")}(game||(game={}));var game;!function(e){var t=function(e){function t(t){var a=e.call(this,t)||this;return a.skinName="resource/mjSkins/comp/DeskCardUp.exml",a}return __extends(t,e),t.prototype.fOnUICreate=function(){this.rotation},t.prototype.fOnClick=function(e){},t}(e.DeskCard);e.DeskCardUp=t,__reflect(t.prototype,"game.DeskCardUp")}(game||(game={}));var game;!function(e){var t=function(t){function a(){var e=t.call(this)||this;return e.skinName="resource/mjSkins/comp/Direction.exml",e}return __extends(a,t),a.prototype.fOnUICreate=function(){this.fHideLight(),this.fInitDir()},a.prototype.fOnClick=function(e){},a.prototype.fInitDir=function(){e.GameManager.fGetIns().m_pFirstPlayerPos==e.PlayePosition.e_Right?(this.m_imgDirDown.texture=RES.getRes("games_res_set_timer_location_1_png"),this.m_imgDirRight.texture=RES.getRes("games_res_set_timer_location_4_png"),this.m_imgDirUp.texture=RES.getRes("games_res_set_timer_location_3_png"),this.m_imgDirLeft.texture=RES.getRes("games_res_set_timer_location_2_png")):e.GameManager.fGetIns().m_pFirstPlayerPos==e.PlayePosition.e_Up?(this.m_imgDirDown.texture=RES.getRes("games_res_set_timer_location_4_png"),this.m_imgDirRight.texture=RES.getRes("games_res_set_timer_location_3_png"),this.m_imgDirUp.texture=RES.getRes("games_res_set_timer_location_2_png"),this.m_imgDirLeft.texture=RES.getRes("games_res_set_timer_location_1_png")):e.GameManager.fGetIns().m_pFirstPlayerPos==e.PlayePosition.e_Left&&(this.m_imgDirDown.texture=RES.getRes("games_res_set_timer_location_3_png"),this.m_imgDirRight.texture=RES.getRes("games_res_set_timer_location_2_png"),this.m_imgDirUp.texture=RES.getRes("games_res_set_timer_location_1_png"),this.m_imgDirLeft.texture=RES.getRes("games_res_set_timer_location_4_png"))},a.prototype.fResetDir=function(t){this.fHideLight();var a=Utils.fDeskPosToGamePosFirst(t);a==e.PlayePosition.e_Down?this.m_imgLightDown.visible=!0:a==e.PlayePosition.e_Up?this.m_imgLightUp.visible=!0:a==e.PlayePosition.e_Left?this.m_imgLightLeft.visible=!0:a==e.PlayePosition.e_Right&&(this.m_imgLightRight.visible=!0)},a.prototype.fHideLight=function(){this.m_imgLightDown.visible=!1,this.m_imgLightUp.visible=!1,this.m_imgLightLeft.visible=!1,this.m_imgLightRight.visible=!1},a}(e.Scene);e.Direction=t,__reflect(t.prototype,"game.Direction")}(game||(game={}));var game;!function(e){var t=function(e){function t(t){var a=e.call(this)||this;return a.m_oCardBase=t,a.skinName="resource/mjSkins/comp/HandCardDown.exml",a}return __extends(t,e),t.prototype.fOnUICreate=function(){this.m_labName.text=this.m_oCardBase.m_sName},t.prototype.fOnClick=function(e){},t}(e.Scene);e.HandCardDown=t,__reflect(t.prototype,"game.HandCardDown")}(game||(game={}));var game;!function(e){var t=function(e){function t(){var t=e.call(this)||this;return t.skinName="resource/mjSkins/layer/Photo.exml",t}return __extends(t,e),t.prototype.fOnUICreate=function(){this.m_imgOwner.visible=!1},t.prototype.fOnClick=function(e){},t.prototype.fVisibleJoinGroup=function(e){this.m_gopJoin.visible=e},t.prototype.fVisibleOwner=function(e){this.m_imgOwner.visible=e},t}(e.Scene);e.Photo=t,__reflect(t.prototype,"game.Photo")}(game||(game={}));var game;!function(e){var t=function(t){function a(){var e=t.call(this)||this;return e.m_aActionCardDown=[],e.m_aActionCardLeft=[],e.m_aActionCardRight=[],e.m_aActionCardUp=[],e.skinName="resource/mjSkins/layer/ActionCardLayer.exml",e}return __extends(a,t),a.prototype.fOnUICreate=function(){},a.prototype.fOnClick=function(e){},a.prototype.fAddCard=function(t,a){var o=Utils.fDeskPosToGamePosFirst(a),n=0,r=0;if(o==e.PlayePosition.e_Left)for(this.m_aActionCardLeft.length>0&&(r=this.m_aActionCardLeft[this.m_aActionCardLeft.length-1].y),n=0;n<t.length;n++){var i=new e.DeskCardLeft(t[n]);this.m_aActionCardLeft.push(i),i.y=r+10+20*n,this.m_gopLeft.addChild(i)}else if(o==e.PlayePosition.e_Right)for(this.m_aActionCardRight.length>0&&(r=this.m_aActionCardRight[this.m_aActionCardRight.length-1].y),n=0;n<t.length;n++){var s=new e.DeskCardRight(t[n]);this.m_aActionCardRight.push(s),s.y=r-10-20*n,this.m_gopRight.addChild(s)}else if(o==e.PlayePosition.e_Down)for(this.m_aActionCardDown.length>0&&(r=this.m_aActionCardDown[this.m_aActionCardDown.length-1].y),n=0;n<t.length;n++){var s=new e.DeskCardDown(t[n]);this.m_aActionCardDown.push(s),s.y=r+10+20*n,this.m_gopDown.addChild(s)}else if(o==e.PlayePosition.e_Up)for(this.m_aActionCardUp.length>0&&(r=this.m_aActionCardUp[this.m_aActionCardUp.length-1].y),n=0;n<t.length;n++){var s=new e.DeskCardUp(t[n]);this.m_aActionCardUp.push(s),s.y=r+10+20*n,this.m_gopUp.addChild(s)}},a}(e.Scene);e.ActionCardLayer=t,__reflect(t.prototype,"game.ActionCardLayer")}(game||(game={}));var game;!function(e){var t=function(t){function a(e,a){var o=t.call(this)||this;return o.m_aCardGroup=[],o.m_aCardGroup=a,o.m_nType=e,o.skinName="resource/mjSkins/layer/ActionLayer.exml",o}return __extends(a,t),a.prototype.fHide=function(){this.m_btnHu.visible=!1,this.m_btnChi.visible=!1,this.m_btnGang.visible=!1,this.m_btnPeng.visible=!1},a.prototype.fOnClick=function(t){if(t==this.m_btnCancel){var o=new e.C2s_EatAction;o.m_pBelongPlayer=e.GameManager.fGetIns().m_pFirstPlayerPos,o.m_pCurrentPlayer=o.m_pBelongPlayer,o.m_aGroupCards=this.m_aCardGroup,o.m_nCardsGroupCount=this.m_aCardGroup.length,o.fGetHead().m_nErrcode=102,Main.fGetIns().m_oGameSocket.fSendPkt(o),e.GameManager.fGetIns().m_aPackets.length>1&&e.GameManager.fGetIns().m_aPackets.splice(0,1),this.parent.removeChild(this),this.m_oMainScene.m_oActionLayer=null,e.GameManager.fGetIns().m_aPackets.length>=1&&(this.m_oMainScene.m_oActionLayer=new a(0,e.GameManager.fGetIns().m_aPackets[0].fGetCards()),this.m_oMainScene.addChild(this))}else if(t==this.m_btnChi||t==this.m_btnPeng||t==this.m_btnHu||t==this.m_btnGang)if(this.m_aCardGroup.length>1){this.fHide(),this.m_gopCards.visible=!0,this.fSetClickButton(this.m_btnBack);for(var n=0;n<this.m_aCardGroup.length;n++){for(var r=new eui.Group,i=this.m_aCardGroup[n].fGetCard(),s=0;s<i.length;s++){var _=new e.HandCardDown(i[n]);r.addChild(_),_.x=80*-s}this.m_gopCards.addChild(r),r.x=-n*s*80-30*n,r.name=""+n,this.fSetClickButton(r)}}else{var o=new e.C2s_EatAction;o.m_pBelongPlayer=e.GameManager.fGetIns().m_pFirstPlayerPos,o.m_pCurrentPlayer=o.m_pBelongPlayer,o.m_aGroupCards=this.m_aCardGroup,o.m_nCardsGroupCount=this.m_aCardGroup.length,o.fGetHead().m_nErrcode=101,Main.fGetIns().m_oGameSocket.fSendPkt(o),e.GameManager.fGetIns().m_aPackets.length>1&&e.GameManager.fGetIns().m_aPackets.splice(0,1)}else if(t==this.m_btnBack)this.m_gopCards.visible=!1,this.fShowAct(this.m_nType);else{var m=t.name,o=new e.C2s_EatAction;o.m_pBelongPlayer=e.GameManager.fGetIns().m_pFirstPlayerPos,o.m_pCurrentPlayer=o.m_pBelongPlayer,o.m_aGroupCards.push(this.m_aCardGroup[parseInt(m)]),o.m_nCardsGroupCount=1,o.fGetHead().m_nErrcode=101,Main.fGetIns().m_oGameSocket.fSendPkt(o),e.GameManager.fGetIns().m_aPackets.length>1&&e.GameManager.fGetIns().m_aPackets.splice(0,1)
}},a.prototype.fShowAct=function(e){0==this.m_nType?(this.m_btnChi.visible=!0,this.fSetClickButton(this.m_btnChi),this.m_btnCancel.x-=80):1==this.m_nType?(this.m_btnPeng.visible=!0,this.fSetClickButton(this.m_btnPeng),this.m_btnCancel.x-=80):2==this.m_nType?(this.m_btnGang.visible=!0,this.fSetClickButton(this.m_btnGang)):3==this.m_nType&&(this.m_btnHu.visible=!0,this.fSetClickButton(this.m_btnHu))},a.prototype.fOnUICreate=function(){this.m_gopCards.visible=!1,this.fHide(),this.fSetClickButton(this.m_btnCancel),this.fShowAct(this.m_nType)},a}(e.Scene);e.ActionLayer=t,__reflect(t.prototype,"game.ActionLayer")}(game||(game={}));var game;!function(e){var t=function(t){function a(){var e=t.call(this)||this;return e.m_aDeskCardsUp=[],e.m_aDeskCardsDown=[],e.m_aDeskCardsLeft=[],e.m_aDeskCardsRight=[],e.skinName="resource/mjSkins/layer/DeskCardLayer.exml",e}return __extends(a,t),a.prototype.fOnUICreate=function(){this.m_oDirection.visible=!1},a.prototype.fShowDir=function(){this.m_oDirection.visible=!0,this.m_oDirection.fInitDir()},a.prototype.fResetDir=function(e){this.m_oDirection.fResetDir(e)},a.prototype.fAddCard=function(t,a){var o=new e.DeskCardDown(t);a==e.PlayePosition.e_Down?(this.m_aDeskCardsDown.push(o),this.m_gopDown.addChild(o),o.x=this.m_aDeskCardsDown.length%6*30,o.y=30*Math.ceil(this.m_aDeskCardsDown.length/6)):a==e.PlayePosition.e_Up?(this.m_aDeskCardsUp.push(o),this.m_gopUp.addChild(o),o.x=this.m_aDeskCardsUp.length%6*30,o.y=30*Math.ceil(this.m_aDeskCardsUp.length/6)):a==e.PlayePosition.e_Left?(this.m_aDeskCardsLeft.push(o),this.m_gopLeft.addChild(o),o.x=this.m_aDeskCardsLeft.length%6*30,o.y=30*Math.ceil(this.m_aDeskCardsLeft.length/6)):a==e.PlayePosition.e_Right&&(this.m_aDeskCardsRight.push(o),this.m_gopRight.addChild(o),o.x=this.m_aDeskCardsRight.length%6*30,o.y=30*Math.ceil(this.m_aDeskCardsRight.length/6))},a}(e.Scene);e.DeskCardLayer=t,__reflect(t.prototype,"game.DeskCardLayer")}(game||(game={}));var game;!function(e){var t=function(t){function a(){var e=t.call(this)||this;return e.skinName="resource/mjSkins/layer/HandCardLayer.exml",e}return __extends(a,t),a.prototype.fOnUICreate=function(){},a.prototype.fOnClick=function(t){console.info("card click");for(var a=e.GameManager.fGetIns().m_aHandCardsDown,o=0;o<a.length;o++)if(a[o]==t)if(-20==a[o].y){var n=e.Packet.fCreateAction(e.Packet.s_PlayHand);n.m_nCardsGroupCount=1,n.m_pBelongPlayer=e.GameManager.fGetIns().m_pFirstPlayerPos,n.m_pCurrentPlayer=e.GameManager.fGetIns().m_pFirstPlayerPos;var r=new e.CardGroup;r.m_oCardStatus=new e.CardStatus,r.m_pBelong=e.GameManager.fGetIns().m_pFirstPlayerPos,r.m_nCardsCount=1,r.fPushCard(a[o].m_oCardBase),n.m_aGroupCards.push(r),Main.fGetIns().m_oGameSocket.fSendPkt(n)}else a[o].y=-20;else-20==a[o].y&&(a[o].y=0);if(t==e.GameManager.fGetIns().m_oTouchHandCard)if(-20==e.GameManager.fGetIns().m_oTouchHandCard.y){var n=e.Packet.fCreateAction(e.Packet.s_PlayHand);n.m_nCardsGroupCount=1,n.m_pBelongPlayer=e.GameManager.fGetIns().m_pFirstPlayerPos,n.m_pCurrentPlayer=e.GameManager.fGetIns().m_pFirstPlayerPos;var r=new e.CardGroup;r.m_oCardStatus=new e.CardStatus,r.m_pBelong=e.GameManager.fGetIns().m_pFirstPlayerPos,r.m_nCardsCount=1,r.fPushCard(e.GameManager.fGetIns().m_oTouchHandCard.m_oCardBase),n.m_aGroupCards.push(r),Main.fGetIns().m_oGameSocket.fSendPkt(n)}else e.GameManager.fGetIns().m_oTouchHandCard.y=-20},a.prototype.fAddHandCardDown=function(){this.m_gopDown.addChild(e.GameManager.fGetIns().m_oTouchHandCard),e.GameManager.fGetIns().m_oTouchHandCard.x=1029,this.fSetClickButton(e.GameManager.fGetIns().m_oTouchHandCard),console.info("有人摸牌1")},a.prototype.fReducCardDown=function(t){var a=e.GameManager.fGetIns().m_aHandCardsDown;if(t.m_oCardBase.fEqual(e.GameManager.fGetIns().m_oTouchHandCard.m_oCardBase,!0))t.parent.removeChild(e.GameManager.fGetIns().m_oTouchHandCard);else for(var o=0;o<a.length;o++)if(a[o].m_oCardBase.fEqual(t.m_oCardBase,!0)){a[o].parent.removeChild(a[o]),this.m_oMainScene.m_oDeskCardLayer.fAddCard(a[o].m_oCardBase,e.PlayePosition.e_Down),a.splice(o,1);var n=Utils.fInsetCard(e.GameManager.fGetIns().m_oTouchHandCard,a);console.info("插入的位置为 + ",n);var r=egret.Tween.get(e.GameManager.fGetIns().m_oTouchHandCard);r.wait(5e3).to({x:78*n},400).wait(2e3).call(function(){for(var e=a.length-1;e>=0;e--)a[e].x=78*e})}},a.prototype.fReducCardDownByCardBase=function(t){var a=e.GameManager.fGetIns().m_aHandCardsDown;if(t.fEqual(e.GameManager.fGetIns().m_oTouchHandCard.m_oCardBase,!0))e.GameManager.fGetIns().m_oTouchHandCard.parent.removeChild(e.GameManager.fGetIns().m_oTouchHandCard);else for(var o=0;o<a.length;o++)if(a[o].m_oCardBase.fEqual(t,!0)){a[o].parent.removeChild(a[o]),this.m_oMainScene.m_oDeskCardLayer.fAddCard(a[o].m_oCardBase,e.PlayePosition.e_Down),a.splice(o,1);var n=Utils.fInsetCard(e.GameManager.fGetIns().m_oTouchHandCard,a);console.info("插入的位置为 + ",n);var r=egret.Tween.get(e.GameManager.fGetIns().m_oTouchHandCard);r.wait(5e3).to({x:78*n},400).wait(2e3).call(function(){for(var e=a.length-1;e>=0;e--)a[e].x=78*e})}},a.prototype.fReduceOtherPeopleCard=function(t){console.info("有人出牌2");var a,o=Utils.fDeskPosToGamePosFirst(t);if(this.m_oMainScene.m_oDeskCardLayer.fAddCard(e.GameManager.fGetIns().m_oChuHandCard.m_oCardBase,t),o==e.PlayePosition.e_Left){a=this.m_gopLeft.numChildren;var n=Utils.fGetRandomNum(0,a-1);this.m_gopLeft.removeChildAt(n)}else if(o==e.PlayePosition.e_Right){a=this.m_gopRight.numChildren;var n=Utils.fGetRandomNum(0,a-1);this.m_gopRight.removeChildAt(n)}else if(o==e.PlayePosition.e_Up){a=this.m_gopUp.numChildren;var n=Utils.fGetRandomNum(0,a-1);this.m_gopUp.removeChildAt(n)}},a.prototype.fAddOtherPeopleCard=function(t){console.info("有人摸牌2");var a,o,n=Utils.fDeskPosToGamePosFirst(t);if(n==e.PlayePosition.e_Left){a=this.m_gopLeft.numChildren;var r=Utils.fGetRandomNum(0,a);o=new eui.Image("majiangzi_cemian2_png"),this.m_gopLeft.addChildAt(o,r),o.y=15*r,o.removeEventListener;for(var i=r+1;i<this.m_gopLeft.numChildren;i++)egret.Tween.removeTweens(this.m_gopLeft.getChildAt(i)),this.m_gopLeft.getChildAt(i).y=15*i}else if(n==e.PlayePosition.e_Right){a=this.m_gopRight.numChildren;var r=Utils.fGetRandomNum(0,a);o=new eui.Image("majiangzi_cemian1_png"),this.m_gopRight.addChildAt(o,r),o.y=15*r;for(var i=r+1;i<this.m_gopRight.numChildren;i++)this.m_gopRight.getChildAt(i).y=15*i}else if(n==e.PlayePosition.e_Up){a=this.m_gopUp.numChildren;var r=Utils.fGetRandomNum(0,a);o=new eui.Image("handcardUp_png"),this.m_gopUp.addChildAt(o,r),o.x=40*r;for(var i=r+1;i<this.m_gopUp.numChildren;i++)this.m_gopUp.getChildAt(i).x=40*i}},a.prototype.fInitHandCardDown=function(){for(var t=e.GameManager.fGetIns().m_aHandCardsDown,a=0;a<t.length;a++){this.m_gopDown.addChildAt(t[a],0),this.fSetClickButton(t[a]);var o=egret.Tween.get(t[a]);o.to({x:78*a},200+30*a)}},a.prototype.fInitHandCardUp=function(){for(var t=0;t<e.GameManager.fGetIns().m_nInitPlayerCardNum;t++){var a=new eui.Image("handcardUp_png");this.m_gopUp.addChild(a);var o=egret.Tween.get(a);o.to({x:40*t},100+30*t)}},a.prototype.fInitHandCardLeft=function(){for(var t=0;t<e.GameManager.fGetIns().m_nInitPlayerCardNum;t++){var a=new eui.Image("majiangzi_cemian2_png");this.m_gopLeft.addChild(a);var o=egret.Tween.get(a);o.to({y:15*t},80+30*t)}},a.prototype.fInitHandCardRight=function(){for(var t=0;t<e.GameManager.fGetIns().m_nInitPlayerCardNum;t++){var a=new eui.Image("majiangzi_cemian1_png");this.m_gopRight.addChild(a);var o=egret.Tween.get(a);o.to({y:15*t},80+30*t)}},a}(e.Scene);e.HandCardLayer=t,__reflect(t.prototype,"game.HandCardLayer")}(game||(game={}));var game;!function(e){var t=function(t){function a(){var e=t.call(this)||this;return e.skinName="resource/mjSkins/layer/PhotoLayer.exml",e}return __extends(a,t),a.prototype.fListenBeginGame=function(){var t=this;this.m_oHandle.fReceiveOnce(t,function(a){var o=a.m_oDisObj;e.GameManager.fGetIns().m_nInitPlayerCardNum=o.m_aCardGroup[0].m_nCardsCount,e.GameManager.fGetIns().m_nAllCardsNum=o.m_nStartCardsNum,e.GameManager.fGetIns().m_oGameBaseInfo.m_aDiceNum=o.m_aDiceNum;for(var n=0;n<o.m_aCardGroup.length;n++)if(o.m_aCardGroup[n].m_pBelong==e.GameManager.fGetIns().m_pFirstPlayerPos)for(var r=o.m_aCardGroup[n].fGetCard(),i=0;i<r.length;i++);t.m_oHandle.fSendMessage(e.Packet.s_BeginGame+"DeskCard"),t.m_oHandle.fSendMessage(e.Packet.s_BeginGame+"HandCard")},e.Packet.s_BeginGame)},a.prototype.fSceneResGroup=function(){return"hall"},a.prototype.fHideAllPhoto=function(){this.m_oPhotoDown.fVisibleJoinGroup(!1),this.m_oPhotoUp.fVisibleJoinGroup(!1),this.m_oPhotoLeft.fVisibleJoinGroup(!1),this.m_oPhotoRight.fVisibleJoinGroup(!1)},a.prototype.fHideAllReady=function(){this.m_imgReadyDown.visible=!1,this.m_imgReadyUp.visible=!1,this.m_imgReadyRight.visible=!1,this.m_imgReadyLeft.visible=!1},a.prototype.fOnUICreate=function(){this.fSetClickButton(this.m_btnReady),this.fHideAllPhoto(),this.fHideAllReady(),e.GameManager.fGetIns().fIsCreateGame()&&(this.m_oPhotoDown.fVisibleJoinGroup(!0),this.m_oPhotoDown.m_labName.text=e.GameManager.fGetIns().m_sFirstPlayerUid,this.m_imgReadyDown.visible=!1,this.m_oPhotoDown.fVisibleOwner(!0))},a.prototype.fResetPhoto=function(){var t=e.GameManager.fGetIns().fGetPlayerInfo();if(t.length>4)return void console.error("fResetPhoto playesInfo.length > 4");this.fHideAllPhoto(),this.fHideAllReady(),e.GameManager.fGetIns().fIsCreateGame()&&(this.m_oPhotoDown.fVisibleJoinGroup(!0),this.m_oPhotoDown.m_labName.text=e.GameManager.fGetIns().m_sFirstPlayerUid);for(var a=0;a<t.length;a++)if(void 0!=t[a]){var o=Utils.fDeskPosToGamePosFirst(t[a].m_pDeskPos),n=this.getChildByName("m_gop"+o),r=n.getChildByName("m_oPhoto"+o);r.visible=!0,r.fVisibleJoinGroup(!0),r.m_labName.text=t[a].m_sUid;var i=n.getChildByName("m_imgReady"+o);this.fSetReadyStatus(t[a].m_nStatus,i),e.GameManager.fGetIns().m_pCreatorPos==t[a].m_pDeskPos?r.fVisibleOwner(!0):r.fVisibleOwner(!1)}},a.prototype.fSetReadyStatus=function(e,t){1==e?t.visible=!0:t.visible=!1},a.prototype.fOnClick=function(t){if(t==this.m_btnReady){var a=e.Packet.fCreateAction(e.Packet.s_PlayerReady);a.m_nReadyNum=1,a.m_aReadyPos.push(e.GameManager.fGetIns().m_pFirstPlayerPos),a.fGetHead().m_nErrcode=1,Main.fGetIns().m_oGameSocket.fSendPkt(a),this.m_btnReady.parent.removeChild(this.m_btnReady),this.m_btnReady=null}},a.prototype.fBeginGame=function(){this.fHideAllReady();var e=egret.Tween.get(this.m_gopDown);e.to({x:4,y:376},300);var t=egret.Tween.get(this.m_gopLeft);t.to({x:4,y:100},300);var a=egret.Tween.get(this.m_gopUp);a.to({x:370,y:0},300);var o=egret.Tween.get(this.m_gopRight);o.to({x:1136,y:116},300)},a}(e.Scene);e.PhotoLayer=t,__reflect(t.prototype,"game.PhotoLayer")}(game||(game={}));var game;!function(e){var t=function(t){function a(){var e=t.call(this)||this;return e.skinName="resource/mjSkins/layer/YaoQingLayer.exml",e}return __extends(a,t),a.prototype.fSceneResGroup=function(){return""},a.prototype.fOnUICreate=function(){this.touchEnabled=!1,this.m_gopNotOwner.touchEnabled=!1,this.m_gopOwner.touchEnabled=!1,e.GameManager.fGetIns().fIsCreateGame()?this.m_gopNotOwner.parent.removeChild(this.m_gopNotOwner):this.m_gopOwner.parent.removeChild(this.m_gopOwner)},a.prototype.fOnClick=function(e){},a}(e.Scene);e.YaoQingLayer=t,__reflect(t.prototype,"game.YaoQingLayer")}(game||(game={}));var game;!function(e){var t=function(t){function a(){var e=t.call(this)||this;return e.skinName="resource/mjSkins/scene/HallScene.exml",e}return __extends(a,t),a.prototype.fSceneResGroup=function(){return"hall"},a.prototype.fOnUICreate=function(){this.fSetClickButton(this.m_btnMj),this.fSetClickButton(this.m_btnXinPu),this.fSetClickButton(this.m_btnPingMing),this.m_gopMj.visible=!1;this.m_oHandle.fReceiveOnce(this,function(t){var a=t.m_oDisObj;a.fGetHead().m_nErrcode?e.TipShow.fShow("创建房间失败"+a.fGetHead().m_nErrcode):e.GameScenenManager.fGetIns().fEnterScene(e.GameSceneName.MAIN)},e.Packet.s_CreateRoom),this.m_oHandle.fReceiveOnce(this,function(t){var a=t.m_oDisObj;a.fGetHead().m_nErrcode?e.TipShow.fShow("加入房间失败"+a.fGetHead().m_nErrcode):e.GameScenenManager.fGetIns().fEnterScene(e.GameSceneName.MAIN)},e.Packet.s_JoinRoom)},a.prototype.fOnClick=function(t){if(t==this.m_btnMj)this.m_gopGame.visible=!1,this.m_gopMj.visible=!0,this.m_gopMj.touchEnabled=!0;else if(this.m_btnXinPu==t){var a=e.Packet.fCreateAction(e.Packet.s_CreateRoom);a.m_gameName=0,a.m_nPayStyle=0,a.m_nCircle=4,Main.fGetIns().m_oGameSocket.fSendPkt(a)}else if(this.m_btnPingMing==t){var o=e.Packet.fCreateAction(e.Packet.s_JoinRoom);o.m_gameName=0,o.m_sRoomId="100000",Main.fGetIns().m_oGameSocket.fSendPkt(o)}},a}(e.Scene);e.HallScene=t,__reflect(t.prototype,"game.HallScene")}(game||(game={}));var game;!function(e){var t=function(e){function t(){var t=e.call(this)||this;return t.m_bCreated=!1,t.bTips=!1,t.skinName="resource/mjSkins/scene/LoadingScene.exml",t}return __extends(t,e),t.prototype.fOnUICreate=function(){this.m_nLastUpdateTime=0,e.prototype.fOnUICreate.call(this)},t.prototype.fUpdate=function(e){this.m_nLastUpdateTime+=e,this.m_nLastUpdateTime>=160&&("加载中..."==this.m_labLoading.text?this.m_labLoading.text="加载中":"加载中"==this.m_labLoading.text?this.m_labLoading.text="加载中.":"加载中."==this.m_labLoading.text?this.m_labLoading.text="加载中..":"加载中.."==this.m_labLoading.text&&(this.m_labLoading.text="加载中..."),this.m_nLastUpdateTime=0)},t.prototype.fSetProgress=function(e){if(this.m_oProgress){this.m_oProgress.setCurProgress(e);Math.floor(100*e)}},t.prototype.fShowTips=function(){},t.prototype.fStartHelpTips=function(){this.bTips=!0,this.fShowTips()},t}(e.Scene);e.LoadingScene=t,__reflect(t.prototype,"game.LoadingScene")}(game||(game={}));var game;!function(e){var t=function(t){function a(){var e=t.call(this)||this;return e.skinName="resource/mjSkins/scene/LoginScene.exml",e}return __extends(a,t),a.prototype.fSceneResGroup=function(){return"login"},a.prototype.fOnUICreate=function(){this.m_textIptUid=new eui.TextInput,this.m_textIptUid.width=15,this.m_textIptUid.prompt="请输入账号:",this.m_textIptUid.textColor=16777215,this.m_textIptUid.restrict="0-9",this.m_textIptUid.x=this.width/7+50,this.m_textIptUid.y=this.height-80,this.addChild(this.m_textIptUid),this.fSetClickButton(this.m_btnLogin)},a.prototype.onChange=function(){},a.prototype.fOnClick=function(t){return Utils.fNotUsefunData(this.m_textIptUid.text)?void e.TipShow.fShow("请输入账号"):(e.GameManager.fGetIns().m_sFirstPlayerUid=this.m_textIptUid.text,Main.fGetIns().m_oGameSocket.fInitSocket(),void e.GameScenenManager.fGetIns().fEnterScene(e.GameSceneName.HALL))},a}(e.Scene);e.LoginScene=t,__reflect(t.prototype,"game.LoginScene")}(game||(game={}));var game;!function(e){var t=function(t){function a(){var e=t.call(this)||this;return e.skinName="resource/mjSkins/scene/GameMainScene.exml",e.fListenRoomInfo(),e.fListenBeginGame(),e.fListenTouchCard(),e.fLisatenChuPai(),e.fListenPeng(),e.fListenGang(),e}return __extends(a,t),a.prototype.fListenGang=function(){this.m_oHandle.fReceiveMessage(this,function(t){console.info("gang行动");var a=t.m_oDisObj;o.m_oDeskCardLayer.fResetDir(a.fGetCurrPlayrPos());var o=this;if(a.fGetBelongPlayerPos()==a.fGetCurrPlayrPos()){if(console.info("gang行动 m_nErrcode"+a.fGetHead().m_nErrcode),100==a.fGetHead().m_nErrcode){if(null!=o.m_oActionLayer)return void e.GameManager.fGetIns().m_aPackets.push(a);o.m_oActionLayer=new e.ActionLayer(2,a.fGetCards()),o.m_oActionLayer.m_oMainScene=o,o.addChild(o.m_oActionLayer)}else if(101==a.fGetHead().m_nErrcode){o.m_oActionLayer.fRemoveCard();for(var n=a.m_aGroupCards[0].fGetCard(),r=0;r<n.length;r++)n[r].m_pBelong==e.GameManager.fGetIns().m_pFirstPlayerPos&&o.m_oHandCardLayer.fReducCardDownByCardBase(n[r]);o.m_oActionCardLayer.fAddCard(n,e.GameManager.fGetIns().m_pFirstPlayerPos)}console.info("gang行动1")}else{var n=a.m_aGroupCards[0].fGetCard();o.m_oActionCardLayer.fAddCard(n,a.fGetCurrPlayrPos())}},e.C2s_ActionBase.s_Gang)},a.prototype.fListenPeng=function(){this.m_oHandle.fReceiveMessage(this,function(t){console.info("peng行动");var a=t.m_oDisObj;o.m_oDeskCardLayer.fResetDir(a.fGetCurrPlayrPos());var o=this;if(a.fGetBelongPlayerPos()==a.fGetCurrPlayrPos()){if(console.info("peng行动 m_nErrcode"+a.fGetHead().m_nErrcode),100==a.fGetHead().m_nErrcode){if(null!=o.m_oActionLayer)return void e.GameManager.fGetIns().m_aPackets.push(a);o.m_oActionLayer=new e.ActionLayer(1,a.fGetCards()),o.m_oActionLayer.m_oMainScene=o,o.addChild(o.m_oActionLayer)}else if(101==a.fGetHead().m_nErrcode){o.m_oActionLayer.fRemoveCard();for(var n=a.m_aGroupCards[0].fGetCard(),r=0;r<n.length;r++)n[r].m_pBelong==e.GameManager.fGetIns().m_pFirstPlayerPos&&o.m_oHandCardLayer.fReducCardDownByCardBase(n[r]);o.m_oActionCardLayer.fAddCard(n,e.GameManager.fGetIns().m_pFirstPlayerPos)}console.info("peng行动1")}else{var n=a.m_aGroupCards[0].fGetCard();o.m_oActionCardLayer.fAddCard(n,a.fGetCurrPlayrPos())}},e.C2s_ActionBase.s_Peng)},a.prototype.fListenEat=function(){this.m_oHandle.fReceiveMessage(this,function(t){console.info("吃行动");var a=t.m_oDisObj;o.m_oDeskCardLayer.fResetDir(a.fGetCurrPlayrPos());var o=this;if(a.fGetBelongPlayerPos()==a.fGetCurrPlayrPos()){if(console.info("吃行动 m_nErrcode"+a.fGetHead().m_nErrcode),100==a.fGetHead().m_nErrcode){if(null!=o.m_oActionLayer)return void e.GameManager.fGetIns().m_aPackets.push(a);o.m_oActionLayer=new e.ActionLayer(0,a.fGetCards()),o.m_oActionLayer.m_oMainScene=o,o.addChild(o.m_oActionLayer)}else if(101==a.fGetHead().m_nErrcode){o.m_oActionLayer.fRemoveCard();for(var n=a.m_aGroupCards[0].fGetCard(),r=0;r<n.length;r++)n[r].m_pBelong==e.GameManager.fGetIns().m_pFirstPlayerPos&&o.m_oHandCardLayer.fReducCardDownByCardBase(n[r]);o.m_oActionCardLayer.fAddCard(n,e.GameManager.fGetIns().m_pFirstPlayerPos)}console.info("吃行动1")}else{var n=a.m_aGroupCards[0].fGetCard();o.m_oActionCardLayer.fAddCard(n,a.fGetCurrPlayrPos())}},e.C2s_ActionBase.s_Eat)},a.prototype.fLisatenChuPai=function(){var t=this;this.m_oHandle.fReceiveMessage(t,function(a){var o=a.m_oDisObj;console.info("有人出牌"),o.m_pBelongPlayer==o.m_pCurrentPlayer?t.m_oHandCardLayer.fReducCardDown(e.GameManager.fGetIns().m_oChuHandCard):t.m_oHandCardLayer.fReduceOtherPeopleCard(o.m_pCurrentPlayer)},e.Packet.s_PlayHand)},a.prototype.fListenRoomInfo=function(){var t=this;this.m_oHandle.fReceiveMessage(t,function(a){a.m_oDisObj;setTimeout(function(){t.m_oPhotoLayer.fResetPhoto(),t.m_labRoomId.text=e.GameManager.fGetIns().m_sRoomId},100)},e.Packet.s_RoomInfo)},a.prototype.fListenTouchCard=function(){var t=this;this.m_oHandle.fReceiveMessage(t,function(e){var a=e.m_oDisObj;console.info("有人摸牌"+a.fGetBelongPlayerPos()+":"+a.fGetCurrPlayrPos()),a.fGetBelongPlayerPos()==a.fGetCurrPlayrPos()?t.m_oHandCardLayer.fAddHandCardDown():t.m_oHandCardLayer.fAddOtherPeopleCard(a.fGetCurrPlayrPos()),t.m_oDeskCardLayer.fResetDir(a.fGetCurrPlayrPos())},e.Packet.s_Touch)},a.prototype.fListenBeginGame=function(){var t=this;this.m_oHandle.fReceiveOnce(t,function(e){e.m_oDisObj;setTimeout(function(){t.m_oYaoQingLayer.parent.removeChild(t.m_oYaoQingLayer),t.m_oPhotoLayer.fBeginGame(),t.m_oHandCardLayer.fInitHandCardDown(),t.m_oHandCardLayer.fInitHandCardUp(),t.m_oHandCardLayer.fInitHandCardLeft(),t.m_oHandCardLayer.fInitHandCardRight(),t.m_oDeskCardLayer.fShowDir()},1e3)},e.Packet.s_BeginGame)},a.prototype.fSceneResGroup=function(){return"main"},a.prototype.fOnUICreate=function(){this.m_oPhotoLayer=new e.PhotoLayer,this.addChild(this.m_oPhotoLayer),this.m_oYaoQingLayer=new e.YaoQingLayer,this.addChild(this.m_oYaoQingLayer),this.m_oHandCardLayer=new e.HandCardLayer,this.addChild(this.m_oHandCardLayer),this.m_oHandCardLayer.touchEnabled=!1,this.m_oHandCardLayer.m_oMainScene=this,this.m_oDeskCardLayer=new e.DeskCardLayer,this.addChild(this.m_oDeskCardLayer),this.m_oDeskCardLayer.m_oMainScene=this,this.m_labRoomId.text=e.GameManager.fGetIns().m_sRoomId,this.fSetClickButton(this.m_btnBegin),this.m_oActionCardLayer=new e.ActionCardLayer,this.addChild(this.m_oActionCardLayer);var t=[],a=new e.CardGroup,o=e.CardBase.fCreateCard(e.WanCard.s_Type_Wan,1,1),n=[];n.push(o),n.push(o),n.push(o),a.fSetCards(n);var r=new e.CardGroup;r.fSetCards(n),t.push(a),t.push(r)},a.prototype.fOnClick=function(t){if(t==this.m_btnBegin){this.m_btnBegin.parent.removeChild(this.m_btnBegin),this.m_btnBegin=null;var a=e.C2s_ActionBase.fCreateAction(e.C2s_ActionBase.s_BeginGame);Main.fGetIns().m_oGameSocket.fSendPkt(a)}},a}(e.Scene);e.MainScene=t,__reflect(t.prototype,"game.MainScene")}(game||(game={}));var game;!function(e){var t=function(){function t(e,t){this.m_nCurrentProgress=0,this.m_oCurProgressL=e,this.m_oCurProgressR=t,this.fInit()}return t.prototype.fInit=function(){this.m_nProgressY=this.m_oCurProgressL.y,this.m_nProgressHeight=this.m_oCurProgressR.height,this.m_oCurProgressAnimat=new e.ProgressAnimation(this.m_oCurProgressL,this.m_oCurProgressR,this.m_oCurProgressL.x,this.m_oCurProgressL.width)},t.prototype.setCurProgress=function(e,t,a){this.m_nCurrentProgress=e,this.setProgress(this.m_oCurProgressAnimat,e,t,a)},t.prototype.setProgress=function(e,t,a,o){var n=!1;if(void 0!=a&&(n=a),egret.Tween.removeTweens(e),n){var r=500,i=egret.Tween.get(e);i.to({progress:t},r),o&&i.call(o)}else e.progress=t},t}();e.Progress=t,__reflect(t.prototype,"game.Progress")}(game||(game={}));var game;!function(e){var t=function(){function e(e,t,a,o){this.currentProgress=0,this.leftBar=e,this.rightBar=t,this.startX=a,this.progressWidth=o}return Object.defineProperty(e.prototype,"progress",{get:function(){return this.currentProgress},set:function(e){this.fSetProgress(e)},enumerable:!0,configurable:!0}),e.prototype.fSetProgress=function(e){var t=e;0>t?t=0:t>1&&(t=1),this.currentProgress=t,this.fSetProgressBase(this.leftBar,this.rightBar,this.startX,t)},e.prototype.fSetProgressBase=function(e,t,a,o){var n=(e.width,Math.ceil(o*this.progressWidth)),r=Math.ceil(n/2),i=Math.floor(n/2);Utils.fClipDisplay(e,0,0,r,e.height,a,e.y),Utils.fClipDisplay(t,e.width-i-1,0,i,e.height,a+r-.8,e.y)},e}();e.ProgressAnimation=t,__reflect(t.prototype,"game.ProgressAnimation")}(game||(game={}));var Utils=function(){function e(){}return e.fResetAnchor=function(e,t,a){var o=e.width,n=e.height,r=.5,i=.5;void 0!=t&&(r=t),void 0!=a&&(i=a);var s=r*o,_=i*n;if(e instanceof eui.Label){var m=e;o=m.measuredWidth,n=m.measuredHeight}var c=e.x,f=e.y,h=c+s-e.anchorOffsetX,u=f+_-e.anchorOffsetY;e.anchorOffsetX=s,e.anchorOffsetY=_,e.x=h,e.y=u},e.fNotUsefunData=function(e){return void 0==e||null==e||""==e?!0:!1},e.fGetAncestor=function(e){for(var t=e;t.parent;)t=t.parent;return t},e.fClipDisplay=function(e,t,a,o,n,r,i){e.mask||(e.mask=new egret.Rectangle),e.mask.x=t,e.mask.y=a,e.mask.width=o,e.mask.height=n,e.x=r-t,e.y=i-a},e.fGetRandomNum=function(e,t){var a=t-e,o=Math.random();return e+Math.round(o*a)},e.fDeskPosToGamePosFirst=function(t){return e.fDeskPosToGamePos(game.GameManager.fGetIns().m_pFirstPlayerPos,t)},e.fDeskPosToGamePos=function(e,t){return e==t?game.PlayePosition.e_Down:e==game.PlayePosition.e_Down?t==game.PlayePosition.e_Right?game.PlayePosition.e_Right:t==game.PlayePosition.e_Left?game.PlayePosition.e_Left:t==game.PlayePosition.e_Up?game.PlayePosition.e_Up:t:e==game.PlayePosition.e_Left?t==game.PlayePosition.e_Right?game.PlayePosition.e_Up:t==game.PlayePosition.e_Down?game.PlayePosition.e_Right:t==game.PlayePosition.e_Up?game.PlayePosition.e_Left:t:e==game.PlayePosition.e_Right?t==game.PlayePosition.e_Left?game.PlayePosition.e_Up:t==game.PlayePosition.e_Down?game.PlayePosition.e_Left:t==game.PlayePosition.e_Up?game.PlayePosition.e_Right:t:e==game.PlayePosition.e_Up?t==game.PlayePosition.e_Down?game.PlayePosition.e_Up:t==game.PlayePosition.e_Right?game.PlayePosition.e_Left:t==game.PlayePosition.e_Left?game.PlayePosition.e_Right:t:t},e.fGetNameByDesktopPos=function(e){return e==game.PlayePosition.e_Up?"北":e==game.PlayePosition.e_Down?"南":e==game.PlayePosition.e_Left?"西":e==game.PlayePosition.e_Right?"东":void 0},e.fGetInitFaPaiDistance=function(e,t){return e>t?0:e=t,2*(e-1)},e.fGetInitFaPaiDirector=function(e,t){return console.info("庄家坐标为"+e),1==t||5==t||9==t?e:2==t||6==t||10==t?e==game.PlayePosition.e_Down?game.PlayePosition.e_Right:e==game.PlayePosition.e_Right?game.PlayePosition.e_Up:e==game.PlayePosition.e_Up?game.PlayePosition.e_Left:game.PlayePosition.e_Down:3==t||7==t||11==t?e==game.PlayePosition.e_Down?game.PlayePosition.e_Up:e==game.PlayePosition.e_Right?game.PlayePosition.e_Left:e==game.PlayePosition.e_Up?game.PlayePosition.e_Down:game.PlayePosition.e_Right:4==t||8==t||12==t?e==game.PlayePosition.e_Down?game.PlayePosition.e_Left:e==game.PlayePosition.e_Right?game.PlayePosition.e_Down:e==game.PlayePosition.e_Up?game.PlayePosition.e_Right:game.PlayePosition.e_Up:null},e.fInsetCard=function(e,t){for(var a=0;a<t.length;a++)if(e.m_oCardBase.m_nPriority<=t[a].m_oCardBase.m_nPriority)return t.splice(a,0,e),a;return-1},e}();__reflect(Utils.prototype,"Utils");